import{d as w,j as a,q as z,g as V,c as i,f as u,a as e,t as p,s as X,T as O,w as N,e as x,l as _,n as F,u as A,r as v,b as T,x as R,k as H,p as Z,F as U,y as Y,z as B,A as W,v as D,R as j,i as ee,B as te,C as se,D as ne,o as ae,E as oe,G as le}from"./index-D-_-lBo8.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as G,f as ie,a as re}from"./formatedTime-C_zGmEUX.js";import{a as ce,_ as ue}from"./phone-XeyzPViJ.js";const de={class:"modal-content"},ve={class:"modal-header"},_e={class:"modal-body"},me=w({__name:"ModalWindow",props:{show:{type:Boolean},title:{}},emits:["close"],setup(h,{emit:t}){const s=t;function o(){s("close")}return(n,r)=>(a(),z(O,{name:"fade"},{default:V(()=>[n.show?(a(),i("div",{key:0,class:"modal-overlay",onClick:N(o,["self"])},[u(O,{name:"slide"},{default:V(()=>[e("div",de,[e("div",ve,[e("h2",null,p(n.title),1),e("button",{onClick:o,class:"close-btn"},"×")]),e("div",_e,[X(n.$slots,"default",{},void 0,!0)])])]),_:3})])):x("",!0)]),_:3}))}}),L=k(me,[["__scopeId","data-v-1b0bf03f"]]),pe={class:"avatar-container"},he=w({__name:"AvatarWithStatus",props:{avatar:{},name:{},status:{}},setup(h){const t=h,s=_(()=>t.avatar),o=_(()=>t.name),n=_(()=>t.status);return(r,c)=>(a(),i("div",pe,[u(G,{name:o.value,avatar:s.value,class:"profile-avatar"},null,8,["name","avatar"]),e("span",{class:F(["status-dot",[n.value==="Online"?"online":n.value==="DoNotDisturb"?"dnd":"invisible"]])},null,2)]))}}),K=k(he,[["__scopeId","data-v-b56f0ac9"]]),fe={class:"user-profile-top"},Ce={class:"user-info-top"},$e={class:"avatar"},ge={class:"user-names"},ye={class:"status-section"},we={class:"user-info"},be={key:0},ke=w({__name:"UserProfile",setup(h){const t=A(),s=_(()=>t.currentUser),o=v(t.currentUser.selectedStatus);function n(){o.value&&t.setStatus(o.value)}return(r,c)=>(a(),i("div",fe,[e("div",Ce,[e("div",$e,[u(K,{avatar:s.value.avatar,name:s.value.identityName,status:s.value.selectedStatus},null,8,["avatar","name","status"])]),e("div",ge,[e("h2",null,p(s.value.nickname)+" @"+p(s.value.identityName),1),e("div",ye,[T(e("select",{"onUpdate:modelValue":c[0]||(c[0]=m=>o.value=m),onChange:c[1]||(c[1]=m=>n()),class:"status-select"},c[2]||(c[2]=[e("option",{value:"Online"},"Online",-1),e("option",{value:"DoNotDisturb"},"Don't disturb",-1),e("option",{value:"Invisible"},"Invisible",-1)]),544),[[R,o.value]])])])]),e("div",we,[e("p",null,[c[3]||(c[3]=e("strong",null,"Last change:",-1)),H(" "+p(Z(ie)(s.value.credentialsChangeDate)),1)]),e("p",null,[c[4]||(c[4]=e("strong",null,"Email:",-1)),H(" "+p(s.value.email),1)]),s.value.description?(a(),i("p",be,[c[5]||(c[5]=e("strong",null,"About",-1)),H(" "+p(s.value.description),1)])):x("",!0)])]))}}),Ie=k(ke,[["__scopeId","data-v-234c5043"]]),Se={};function Me(h,t){return null}const xe=k(Se,[["render",Me]]),Ve={class:"logout-section"},Ue=w({__name:"Logout",setup(h){const t=A();function s(){t.logout(),Y.push("/login")}return(o,n)=>(a(),i(U,null,[n[1]||(n[1]=e("p",null,[e("strong",null,"Do you want to log out of your account?")],-1)),e("div",null,[e("div",Ve,[e("button",{class:"logout-button",onClick:n[0]||(n[0]=r=>s())},"Logout")])])],64))}}),Te=k(Ue,[["__scopeId","data-v-12e857ec"]]),ze={class:"user-card"},Ne={class:"settings-container"},Ae={class:"settings-menu"},Be=["onClick"],Pe={class:"content-container"},De={class:"settings-content"},Le=w({__name:"UserView",setup(h){const t=A();_(()=>t.currentUser);const s=["Profile","Settings","Logout"],o=v(s[0]);function n(r){o.value=r}return(r,c)=>(a(),i("div",ze,[e("div",Ne,[e("aside",Ae,[e("ul",null,[(a(),i(U,null,B(s,(m,d)=>e("li",{key:d},[e("button",{class:F({active:o.value===m}),onClick:C=>n(m)},p(m),11,Be)])),64))])])]),e("div",Pe,[e("main",De,[o.value==="Profile"?(a(),z(Ie,{key:0})):o.value==="Settings"?(a(),z(xe,{key:1})):o.value==="Logout"?(a(),z(Te,{key:2})):x("",!0)])])]))}}),Fe=k(Le,[["__scopeId","data-v-327a5efd"]]),We={class:"profile-widget"},qe={class:"avatar"},Ee={class:"profile-info"},He={class:"username"},Ge={class:"user-tag"},Ke=w({__name:"ProfileCard",setup(h){const t=A(),s=_(()=>t.currentUser.avatar),o=_(()=>t.currentUser.nickname),n=_(()=>t.currentUser.identityName),r=_(()=>t.currentUser.selectedStatus),c=v(!1);return(m,d)=>(a(),i("div",We,[e("div",qe,[u(K,{avatar:s.value,name:o.value,status:r.value},null,8,["avatar","name","status"])]),e("div",Ee,[e("div",He,p(o.value),1),e("div",Ge,"@"+p(n.value),1)]),e("button",{class:"settings-button",onClick:d[0]||(d[0]=C=>c.value=!0)},d[2]||(d[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",class:"settings-icon"},[e("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.5-.03-.62.19l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.5.03.62-.19l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})],-1)])),u(L,{show:c.value,title:"User Environment",onClose:d[1]||(d[1]=C=>c.value=!1)},{default:V(()=>[u(Fe)]),_:1},8,["show"])]))}}),Oe=k(Ke,[["__scopeId","data-v-77744551"]]),Re=["width","height"],Ze=["fill"],J=w({__name:"CreateIcon",props:{fillColor:{},size:{}},setup(h){return(t,s)=>(a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z",fill:t.fillColor},null,8,Ze)],8,Re))}}),je={class:"sidebar-communities"},Je={class:"community-list"},Qe=["onClick"],Xe={class:"community-avatar"},Ye={class:"add-community-button"},et={key:0,class:"success-message"},tt=w({__name:"CommunitySidebar",setup(h){const t=new j("https://dotflopp.ru/api"),s=W(),o=v(!1),n=v(""),r=v(""),c=_(()=>s.communities),m=_(()=>s.activeCommunityId);function d(b){s.setActiveCommunity(b)}async function C(){if(n.value.trim())try{const b=await t.createNewCommunities(n.value);s.addCommunity(b),r.value="Сообщество успешно создано!"}catch(b){console.error("Ошибка при создании сообщества:",b),r.value="Не удалось создать сообщество."}}return(b,$)=>(a(),i("div",je,[e("ul",Je,[(a(!0),i(U,null,B(c.value,f=>(a(),i("li",{key:f.id,class:F(["community-item",{active:f.id===m.value}]),onClick:P=>d(f.id)},[e("div",Xe,[f.avatar?x("",!0):(a(),z(G,{key:0,name:f.name,avatar:f.avatar},null,8,["name","avatar"]))])],10,Qe))),128))]),e("div",Ye,[e("button",{class:"add-btn",onClick:$[0]||($[0]=f=>o.value=!0)},[u(J,{fillColor:"white",size:"70%"})]),u(L,{show:o.value,title:"Creating Community",onClose:$[2]||($[2]=f=>o.value=!1)},{default:V(()=>[e("form",{onSubmit:N(C,["prevent"]),class:"community-form"},[T(e("input",{id:"community-name","onUpdate:modelValue":$[1]||($[1]=f=>n.value=f),type:"text",placeholder:"community name",required:""},null,512),[[D,n.value]]),r.value?(a(),i("p",et,p(r.value),1)):x("",!0),$[3]||($[3]=e("button",{type:"submit",class:"create-button"},"Create",-1))],32)]),_:1},8,["show"])])]))}}),st=k(tt,[["__scopeId","data-v-fc60142f"]]),nt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"},at={"clip-path":"url(#clip0_2311_9433)"},ot=["fill"],lt=w({__name:"PersonIcon",props:{fillColor:{}},setup(h){return(t,s)=>(a(),i("svg",nt,[e("g",at,[e("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V19C4 19.55 4.45 20 5 20H19C19.55 20 20 19.55 20 19V18C20 15.34 14.67 14 12 14Z",fill:t.fillColor},null,8,ot)])]))}}),it={key:0,class:"sidebar-content"},rt={class:"current-communities"},ct={class:"community-card"},ut={class:"community-name"},dt={key:0,class:"message"},vt={class:"sidebar-channels"},_t={class:"channel-list"},mt=["onClick"],pt={class:"channel"},ht={class:"channel-name"},ft=["onClick"],Ct={class:"add-channel-button"},$t={class:"channel-type"},gt={class:"status-section"},yt={key:0,class:"message"},wt=w({__name:"ChannelSidebar",setup(h){const t=new j("https://dotflopp.ru/api"),s=W(),o=v(!1),n=v(""),r=v(""),c=v(!1),m=v(""),d=v("TextChannel"),C=v(""),b=_(()=>s.activeCommunityId),$=v("0"),f=_(()=>b.value?s.getCommunityById(b.value):null),P=_(()=>s.channels),q=_(()=>s.activeChannelId);function E(y){s.setActiveChannel(y)}async function M(){if(n.value.trim())try{const l=`https://dotflopp.ru/invite/${(await t.createInvitation(s.getactiveCommunityId,n.value)).id}`;await navigator.clipboard.writeText(l),r.value="Invitation copied to clipboard"}catch(y){console.error("Ошибка при создании приглашения:",y),r.value="Не удалось создать приглашение."}}async function S(){if(!(!m.value.trim()||d.value.length==0))try{const y={name:m.value,type:d.value,parentId:$.value},l=await t.createNewChannel(b.value,y);console.log(l),s.addChannel(l),C.value="Канал успешно создан!",$.value="0"}catch(y){console.error("Ошибка при создании канала:",y),C.value="Не удалось создать канал."}}function I(y){$.value=y}return(y,l)=>f.value?(a(),i("div",it,[e("div",rt,[e("div",ct,[e("div",ut,p(f.value.name),1),e("button",{class:"addPerson-btn",onClick:l[0]||(l[0]=g=>o.value=!0)},[u(lt,{class:"addPerson",fillColor:"white"})]),u(L,{show:o.value,title:"Create Invitation",onClose:l[2]||(l[2]=g=>o.value=!1)},{default:V(()=>[e("form",{onSubmit:N(M,["prevent"]),class:"invitation-form"},[T(e("input",{id:"lifetime","onUpdate:modelValue":l[1]||(l[1]=g=>n.value=g),type:"text",placeholder:"Seconds",required:""},null,512),[[D,n.value]]),r.value?(a(),i("p",dt,p(r.value),1)):x("",!0),l[7]||(l[7]=e("button",{type:"submit",class:"create-button"},"Create Invitation",-1))],32)]),_:1},8,["show"])])]),e("div",vt,[e("ul",_t,[(a(!0),i(U,null,B(P.value,g=>(a(),i("li",{key:g.id,class:F(["channel-item",{active:g.id===q.value}]),onClick:Q=>E(g.id)},[e("div",pt,[e("div",ht,p(g.name),1),e("button",{class:"addChannel-btn-simple",onClick:Q=>(c.value=!0,I(g.id))},[u(J,{fillColor:"white",size:"100%"})],8,ft)])],10,mt))),128))]),e("div",Ct,[e("button",{class:"addChannel-btn",onClick:l[3]||(l[3]=g=>c.value=!0)},l[8]||(l[8]=[e("p",null,"create channel",-1)]))]),u(L,{show:c.value,title:"Create channel",onClose:l[6]||(l[6]=g=>c.value=!1)},{default:V(()=>[e("form",{onSubmit:N(S,["prevent"]),class:"invitation-form"},[T(e("input",{id:"channelName","onUpdate:modelValue":l[4]||(l[4]=g=>m.value=g),type:"text",placeholder:"channel name",required:""},null,512),[[D,m.value]]),e("div",$t,[l[10]||(l[10]=e("p",null,"Channel type",-1)),e("div",gt,[T(e("select",{"onUpdate:modelValue":l[5]||(l[5]=g=>d.value=g),class:"channeltype-select"},l[9]||(l[9]=[e("option",{value:"TextChannel"},"TextChannel",-1),e("option",{value:"VoiceChannel"},"VoiceChannel",-1),e("option",{value:"CategoryChannel"},"CategoryChannel",-1)]),512),[[R,d.value]])])]),C.value?(a(),i("p",yt,p(C.value),1)):x("",!0),l[11]||(l[11]=e("button",{type:"submit",class:"create-button"},"Create Channel",-1))],32)]),_:1},8,["show"])])])):x("",!0)}}),bt=k(wt,[["__scopeId","data-v-19cc8aeb"]]),kt={},It={class:"top-bar"},St={class:"call-icons"},Mt={class:"call-icon",id:"phone-btn"},xt={class:"call-icon",id:"camera-btn"};function Vt(h,t){const s=ee("router-link");return a(),i("header",It,[t[2]||(t[2]=e("div",{class:"server-name"},"Chat",-1)),e("div",St,[e("button",Mt,[u(s,{to:"/rooms"},{default:V(()=>t[0]||(t[0]=[e("img",{src:ce},null,-1)])),_:1})]),e("button",xt,[u(s,{to:"/rooms"},{default:V(()=>t[1]||(t[1]=[e("img",{src:ue},null,-1)])),_:1})])])])}const Ut=k(kt,[["render",Vt],["__scopeId","data-v-75814ce4"]]),Tt=["width","height"],zt=["fill"],Nt=w({__name:"СlipIcon",props:{fillColor:{},size:{}},setup(h){return(t,s)=>(a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M16.5 6.75015V17.3301C16.5 19.4201 14.97 21.2801 12.89 21.4801C10.5 21.7101 8.5 19.8401 8.5 17.5001V5.14015C8.5 3.83015 9.44 2.64015 10.74 2.51015C12.24 2.36015 13.5 3.53015 13.5 5.00015V15.5001C13.5 16.0501 13.05 16.5001 12.5 16.5001C11.95 16.5001 11.5 16.0501 11.5 15.5001V6.75015C11.5 6.34015 11.16 6.00015 10.75 6.00015C10.34 6.00015 10 6.34015 10 6.75015V15.3601C10 16.6701 10.94 17.8601 12.24 17.9901C13.74 18.1401 15 16.9701 15 15.5001V5.17015C15 3.08015 13.47 1.22015 11.39 1.02015C9.01 0.790146 7 2.66015 7 5.00015V17.2701C7 20.1401 9.1 22.7101 11.96 22.9801C15.25 23.2801 18 20.7201 18 17.5001V6.75015C18 6.34015 17.66 6.00015 17.25 6.00015C16.84 6.00015 16.5 6.34015 16.5 6.75015Z",fill:t.fillColor},null,8,zt)],8,Tt))}}),At={class:"message-avatars"},Bt={class:"message-content"},Pt={class:"message-header"},Dt={class:"username"},Lt={class:"timestamp"},Ft={class:"message-body"},Wt={class:"message-input"},qt=["disabled"],Et=["onKeydown"],Ht=w({__name:"Chat",setup(h){const t=te(),s=W();A();const o=v(null),n=v();se();const r=_(()=>s.activeChannelId),c=_(()=>t.getMessages),m=_(()=>t.getUsers),d=v(null),C=v("");v();const b=ne("CGW");function $(M){t.addMessage(M),P()}ae(()=>{t.fetchMessages(r.value),b.on("MessageCreated",$)}),oe(()=>{b.off("MessageCreated",$)});async function f(){if(C.value.trim())try{await t.sendMessage(r.value,C.value),C.value=""}catch(M){console.error("Ошибка отправки сообщения:",M)}}function P(){d.value&&(d.value.scrollTop=d.value.scrollHeight)}function q(){n.value&&n.value.click()}function E(M){console.log("кликаю");const S=M.target;S.files&&S.files.length>0&&(o.value=S.files[0])}return(M,S)=>(a(),i(U,null,[e("section",{class:"chat-area",ref_key:"chatContainer",ref:d},[(a(!0),i(U,null,B(c.value,I=>{var y;return a(),i("div",{key:I.id,class:"message"},[e("div",At,[u(G,{name:m.value[I.userId].nickname,avatar:m.value[I.userId].avatar},null,8,["name","avatar"])]),e("div",Bt,[e("div",Pt,[e("span",Dt,p((y=m.value[I.userId])==null?void 0:y.nickname),1),e("span",Lt,p(Z(re)(I.createdAt)),1)]),e("div",Ft,p(I.text),1)])])}),128))],512),e("footer",Wt,[e("div",{class:"clipicon-wrapper",onClick:S[0]||(S[0]=I=>q()),disabled:!o.value},[u(Nt,{"fill-color":"white",size:"55%",class:"clipicon"})],8,qt),e("input",{type:"file",accept:"image/*, .pdf, .txt",onChange:E,ref_key:"fileInput",ref:n,hidden:""},null,544),T(e("input",{type:"text",placeholder:"Type a message...","onUpdate:modelValue":S[1]||(S[1]=I=>C.value=I),onKeydown:le(N(f,["prevent"]),["enter"])},null,40,Et),[[D,C.value]]),e("button",{class:"send-button",onClick:f},"Send")])],64))}}),Gt=k(Ht,[["__scopeId","data-v-22f08a5c"]]),Kt={class:"sidebar-users"},Ot={class:"user-list"},Rt={class:"user-avatar"},Zt={class:"user-name"},jt=w({__name:"MembersSidebar",setup(h){const t=W(),s=_(()=>t.getCommunityMembers);return(o,n)=>(a(),i("div",Kt,[n[0]||(n[0]=e("div",{class:"top-bar"},null,-1)),e("ul",Ot,[(a(!0),i(U,null,B(s.value,r=>(a(),i("li",{key:r.userId,class:"user-item"},[e("div",Rt,[u(K,{name:r.nickname,avatar:r.avatar,status:r.status},null,8,["name","avatar","status"])]),e("span",Zt,p(r.nickname),1)]))),128))])]))}}),Jt=k(jt,[["__scopeId","data-v-18c0f87e"]]),Qt={class:"app-container"},Xt={class:"sidebar"},Yt={class:"main-content"},es={class:"profile"},ts={class:"main-content"},ss={class:"community-member"},is=w({__name:"MainPage",setup(h){return(t,s)=>(a(),i("div",Qt,[u(st),e("div",Xt,[e("div",Yt,[u(bt)]),e("div",es,[u(Oe)])]),e("main",ts,[u(Ut),u(Gt)]),e("div",ss,[u(Jt)])]))}});export{is as default};
