import{d as y,j as n,q as V,g as x,c as i,f as m,a as e,t as w,s as se,T as J,w as P,e as M,l as C,n as T,u as R,r as $,b as D,x as Q,k as E,p as X,F as S,y as ne,z,A as O,v as N,R as q,i as oe,o as Y,B as ee,C as ae,D as le,E as ie,G as re}from"./index-BYDOBkoQ.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as G,f as ce,a as ue}from"./formatedTime-js3WnzCX.js";import{a as de,_ as ve}from"./phone-XeyzPViJ.js";const _e={class:"modal-content"},me={class:"modal-header"},pe={class:"modal-body"},fe=y({__name:"ModalWindow",props:{show:{type:Boolean},title:{}},emits:["close"],setup(f,{emit:t}){const s=t;function a(){s("close")}return(r,v)=>(n(),V(J,{name:"fade"},{default:x(()=>[r.show?(n(),i("div",{key:0,class:"modal-overlay",onClick:P(a,["self"])},[m(J,{name:"slide"},{default:x(()=>[e("div",_e,[e("div",me,[e("h2",null,w(r.title),1),e("button",{onClick:a,class:"close-btn"},"Ã—")]),e("div",pe,[se(r.$slots,"default",{},void 0,!0)])])]),_:3})])):M("",!0)]),_:3}))}}),F=I(fe,[["__scopeId","data-v-1b0bf03f"]]),he={class:"avatar-container"},Ce=y({__name:"AvatarWithStatus",props:{avatar:{},name:{},status:{}},setup(f){const t=f,s=C(()=>t.avatar),a=C(()=>t.name),r=C(()=>t.status);return(v,c)=>(n(),i("div",he,[m(G,{name:a.value,avatar:s.value,class:"profile-avatar"},null,8,["name","avatar"]),e("span",{class:T(["status-dot",[r.value==="Online"?"online":r.value==="DoNotDisturb"?"dnd":"invisible"]])},null,2)]))}}),K=I(Ce,[["__scopeId","data-v-b56f0ac9"]]),ge={class:"user-profile-top"},$e={class:"user-info-top"},we={class:"avatar"},ye={class:"user-names"},be={class:"status-section"},ke={class:"user-info"},Ie={key:0},Me=y({__name:"UserProfile",setup(f){const t=R(),s=C(()=>t.currentUser),a=$(t.currentUser.selectedStatus);function r(){a.value&&t.setStatus(a.value)}return(v,c)=>(n(),i("div",ge,[e("div",$e,[e("div",we,[m(K,{avatar:s.value.avatar,name:s.value.identityName,status:s.value.selectedStatus},null,8,["avatar","name","status"])]),e("div",ye,[e("h2",null,w(s.value.nickname)+" @"+w(s.value.identityName),1),e("div",be,[D(e("select",{"onUpdate:modelValue":c[0]||(c[0]=h=>a.value=h),onChange:c[1]||(c[1]=h=>r()),class:"status-select"},c[2]||(c[2]=[e("option",{value:"Online"},"Online",-1),e("option",{value:"DoNotDisturb"},"Don't disturb",-1),e("option",{value:"Invisible"},"Invisible",-1)]),544),[[Q,a.value]])])])]),e("div",ke,[e("p",null,[c[3]||(c[3]=e("strong",null,"Last change:",-1)),E(" "+w(X(ce)(s.value.credentialsChangeDate)),1)]),e("p",null,[c[4]||(c[4]=e("strong",null,"Email:",-1)),E(" "+w(s.value.email),1)]),s.value.description?(n(),i("p",Ie,[c[5]||(c[5]=e("strong",null,"About",-1)),E(" "+w(s.value.description),1)])):M("",!0)])]))}}),Se=I(Me,[["__scopeId","data-v-234c5043"]]),xe={};function Ue(f,t){return null}const Ve=I(xe,[["render",Ue]]),ze={class:"logout-section"},De=y({__name:"Logout",setup(f){const t=R();function s(){t.logout(),ne.push("/login")}return(a,r)=>(n(),i(S,null,[r[1]||(r[1]=e("p",null,[e("strong",null,"Do you want to log out of your account?")],-1)),e("div",null,[e("div",ze,[e("button",{class:"logout-button",onClick:r[0]||(r[0]=v=>s())},"Logout")])])],64))}}),Pe=I(De,[["__scopeId","data-v-12e857ec"]]),Te={class:"user-card"},Le={class:"settings-container"},Ae={class:"settings-menu"},Be=["onClick"],He={class:"content-container"},Ne={class:"settings-content"},Fe=y({__name:"UserView",setup(f){const t=R();C(()=>t.currentUser);const s=["Profile","Settings","Logout"],a=$(s[0]);function r(v){a.value=v}return(v,c)=>(n(),i("div",Te,[e("div",Le,[e("aside",Ae,[e("ul",null,[(n(),i(S,null,z(s,(h,l)=>e("li",{key:l},[e("button",{class:T({active:a.value===h}),onClick:d=>r(h)},w(h),11,Be)])),64))])])]),e("div",He,[e("main",Ne,[a.value==="Profile"?(n(),V(Se,{key:0})):a.value==="Settings"?(n(),V(Ve,{key:1})):a.value==="Logout"?(n(),V(Pe,{key:2})):M("",!0)])])]))}}),Re=I(Fe,[["__scopeId","data-v-327a5efd"]]),Oe={class:"profile-widget"},je={class:"avatar"},We={class:"profile-info"},Ze={class:"username"},Ee={class:"user-tag"},qe=y({__name:"ProfileCard",setup(f){const t=R(),s=C(()=>t.currentUser.avatar),a=C(()=>t.currentUser.nickname),r=C(()=>t.currentUser.identityName),v=C(()=>t.currentUser.selectedStatus),c=$(!1);return(h,l)=>(n(),i("div",Oe,[e("div",je,[m(K,{avatar:s.value,name:a.value,status:v.value},null,8,["avatar","name","status"])]),e("div",We,[e("div",Ze,w(a.value),1),e("div",Ee,"@"+w(r.value),1)]),e("button",{class:"settings-button",onClick:l[0]||(l[0]=d=>c.value=!0)},l[2]||(l[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",class:"settings-icon"},[e("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.5-.03-.62.19l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.5.03.62-.19l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})],-1)])),m(F,{show:c.value,title:"User Environment",onClose:l[1]||(l[1]=d=>c.value=!1)},{default:x(()=>[m(Re)]),_:1},8,["show"])]))}}),Ge=I(qe,[["__scopeId","data-v-77744551"]]),Ke=["width","height"],Je=["fill"],te=y({__name:"CreateIcon",props:{fillColor:{},size:{}},setup(f){return(t,s)=>(n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z",fill:t.fillColor},null,8,Je)],8,Ke))}}),Qe={class:"sidebar-communities"},Xe={class:"community-list"},Ye=["onClick"],et={class:"community-avatar"},tt={class:"add-community-button"},st={key:0,class:"success-message"},nt=y({__name:"CommunitySidebar",setup(f){const t=new q("https://dotflopp.ru/api"),s=O(),a=$(!1),r=$(""),v=$(""),c=C(()=>s.communities),h=C(()=>s.activeCommunityId);function l(u){s.setActiveCommunity(u)}async function d(){if(r.value.trim())try{const u=await t.createNewCommunities(r.value);s.addCommunity(u),v.value="Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½Ð¾!"}catch(u){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð°:",u),v.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð¾."}}return(u,g)=>(n(),i("div",Qe,[e("ul",Xe,[(n(!0),i(S,null,z(c.value,b=>(n(),i("li",{key:b.id,class:T(["community-item",{active:b.id===h.value}]),onClick:A=>l(b.id)},[e("div",et,[b.avatar?M("",!0):(n(),V(G,{key:0,name:b.name,avatar:b.avatar},null,8,["name","avatar"]))])],10,Ye))),128))]),e("div",tt,[e("button",{class:"add-btn",onClick:g[0]||(g[0]=b=>a.value=!0)},[m(te,{fillColor:"white",size:"70%"})]),m(F,{show:a.value,title:"Creating Community",onClose:g[2]||(g[2]=b=>a.value=!1)},{default:x(()=>[e("form",{onSubmit:P(d,["prevent"]),class:"community-form"},[D(e("input",{id:"community-name","onUpdate:modelValue":g[1]||(g[1]=b=>r.value=b),type:"text",placeholder:"community name",required:""},null,512),[[N,r.value]]),v.value?(n(),i("p",st,w(v.value),1)):M("",!0),g[3]||(g[3]=e("button",{type:"submit",class:"create-button"},"Create",-1))],32)]),_:1},8,["show"])])]))}}),ot=I(nt,[["__scopeId","data-v-fc60142f"]]),at={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"},lt={"clip-path":"url(#clip0_2311_9433)"},it=["fill"],rt=y({__name:"PersonIcon",props:{fillColor:{}},setup(f){return(t,s)=>(n(),i("svg",at,[e("g",lt,[e("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V19C4 19.55 4.45 20 5 20H19C19.55 20 20 19.55 20 19V18C20 15.34 14.67 14 12 14Z",fill:t.fillColor},null,8,it)])]))}}),ct={key:0,class:"sidebar-content"},ut={class:"current-communities"},dt={class:"community-card"},vt={class:"community-name"},_t={key:0,class:"message"},mt={class:"sidebar-channels"},pt={class:"channel-list"},ft=["onClick"],ht={class:"channel"},Ct={class:"channel-name"},gt=["onClick"],$t={class:"add-channel-button"},wt={class:"channel-type"},yt={class:"status-section"},bt={key:0,class:"message"},kt=y({__name:"ChannelSidebar",setup(f){const t=new q("https://dotflopp.ru/api"),s=O(),a=$(!1),r=$(""),v=$(""),c=$(!1),h=$(""),l=$("TextChannel"),d=$(""),u=C(()=>s.activeCommunityId),g=$("0"),b=C(()=>u.value?s.getCommunityById(u.value):null),A=C(()=>s.channels),B=C(()=>s.activeChannelId);function H(_){s.setActiveChannel(_)}async function j(){if(r.value.trim())try{const o=`https://dotflopp.ru/invite/${(await t.createInvitation(s.getactiveCommunityId,r.value)).id}`;await navigator.clipboard.writeText(o),v.value="Invitation copied to clipboard"}catch(_){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐµÐ½Ð¸Ñ:",_),v.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐµÐ½Ð¸Ðµ."}}async function W(){if(!(!h.value.trim()||l.value.length==0))try{const _={name:h.value,type:l.value,parentId:g.value},o=await t.createNewChannel(u.value,_);console.log(o),s.addChannel(o),d.value="ÐšÐ°Ð½Ð°Ð» ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½!",g.value="0"}catch(_){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ ÐºÐ°Ð½Ð°Ð»Ð°:",_),d.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÐºÐ°Ð½Ð°Ð»."}}function Z(_){g.value=_}return(_,o)=>b.value?(n(),i("div",ct,[e("div",ut,[e("div",dt,[e("div",vt,w(b.value.name),1),e("button",{class:"addPerson-btn",onClick:o[0]||(o[0]=p=>a.value=!0)},[m(rt,{class:"addPerson",fillColor:"white"})]),m(F,{show:a.value,title:"Create Invitation",onClose:o[2]||(o[2]=p=>a.value=!1)},{default:x(()=>[e("form",{onSubmit:P(j,["prevent"]),class:"invitation-form"},[D(e("input",{id:"lifetime","onUpdate:modelValue":o[1]||(o[1]=p=>r.value=p),type:"text",placeholder:"Seconds",required:""},null,512),[[N,r.value]]),v.value?(n(),i("p",_t,w(v.value),1)):M("",!0),o[7]||(o[7]=e("button",{type:"submit",class:"create-button"},"Create Invitation",-1))],32)]),_:1},8,["show"])])]),e("div",mt,[e("ul",pt,[(n(!0),i(S,null,z(A.value,p=>(n(),i("li",{key:p.id,class:T(["channel-item",{active:p.id===B.value}]),onClick:k=>H(p.id)},[e("div",ht,[e("div",Ct,w(p.name),1),e("button",{class:"addChannel-btn-simple",onClick:k=>(c.value=!0,Z(p.id))},[m(te,{fillColor:"white",size:"100%"})],8,gt)])],10,ft))),128))]),e("div",$t,[e("button",{class:"addChannel-btn",onClick:o[3]||(o[3]=p=>c.value=!0)},o[8]||(o[8]=[e("p",null,"create channel",-1)]))]),m(F,{show:c.value,title:"Create channel",onClose:o[6]||(o[6]=p=>c.value=!1)},{default:x(()=>[e("form",{onSubmit:P(W,["prevent"]),class:"invitation-form"},[D(e("input",{id:"channelName","onUpdate:modelValue":o[4]||(o[4]=p=>h.value=p),type:"text",placeholder:"channel name",required:""},null,512),[[N,h.value]]),e("div",wt,[o[10]||(o[10]=e("p",null,"Channel type",-1)),e("div",yt,[D(e("select",{"onUpdate:modelValue":o[5]||(o[5]=p=>l.value=p),class:"channeltype-select"},o[9]||(o[9]=[e("option",{value:"TextChannel"},"TextChannel",-1),e("option",{value:"VoiceChannel"},"VoiceChannel",-1),e("option",{value:"CategoryChannel"},"CategoryChannel",-1)]),512),[[Q,l.value]])])]),d.value?(n(),i("p",bt,w(d.value),1)):M("",!0),o[11]||(o[11]=e("button",{type:"submit",class:"create-button"},"Create Channel",-1))],32)]),_:1},8,["show"])])])):M("",!0)}}),It=I(kt,[["__scopeId","data-v-19cc8aeb"]]),Mt={},St={class:"top-bar"},xt={class:"call-icons"},Ut={class:"call-icon",id:"phone-btn"},Vt={class:"call-icon",id:"camera-btn"};function zt(f,t){const s=oe("router-link");return n(),i("header",St,[t[2]||(t[2]=e("div",{class:"server-name"},"Chat",-1)),e("div",xt,[e("button",Ut,[m(s,{to:"/rooms"},{default:x(()=>t[0]||(t[0]=[e("img",{src:de},null,-1)])),_:1})]),e("button",Vt,[m(s,{to:"/rooms"},{default:x(()=>t[1]||(t[1]=[e("img",{src:ve},null,-1)])),_:1})])])])}const Dt=I(Mt,[["render",zt],["__scopeId","data-v-75814ce4"]]),Pt=["width","height"],Tt=["fill"],Lt=y({__name:"Ð¡lipIcon",props:{fillColor:{},size:{}},setup(f){return(t,s)=>(n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M16.5 6.75015V17.3301C16.5 19.4201 14.97 21.2801 12.89 21.4801C10.5 21.7101 8.5 19.8401 8.5 17.5001V5.14015C8.5 3.83015 9.44 2.64015 10.74 2.51015C12.24 2.36015 13.5 3.53015 13.5 5.00015V15.5001C13.5 16.0501 13.05 16.5001 12.5 16.5001C11.95 16.5001 11.5 16.0501 11.5 15.5001V6.75015C11.5 6.34015 11.16 6.00015 10.75 6.00015C10.34 6.00015 10 6.34015 10 6.75015V15.3601C10 16.6701 10.94 17.8601 12.24 17.9901C13.74 18.1401 15 16.9701 15 15.5001V5.17015C15 3.08015 13.47 1.22015 11.39 1.02015C9.01 0.790146 7 2.66015 7 5.00015V17.2701C7 20.1401 9.1 22.7101 11.96 22.9801C15.25 23.2801 18 20.7201 18 17.5001V6.75015C18 6.34015 17.66 6.00015 17.25 6.00015C16.84 6.00015 16.5 6.34015 16.5 6.75015Z",fill:t.fillColor},null,8,Tt)],8,Pt))}}),At={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Bt={"clip-path":"url(#clip0_2311_5181)"},Ht=["fill"],Nt=y({__name:"DeleteIcon",props:{fillColor:{}},setup(f){return(t,s)=>(n(),i("svg",At,[e("g",Bt,[e("path",{d:"M6 19C6 20.1 6.9 21 8 21H16C17.1 21 18 20.1 18 19V9C18 7.9 17.1 7 16 7H8C6.9 7 6 7.9 6 9V19ZM18 4H15.5L14.79 3.29C14.61 3.11 14.35 3 14.09 3H9.91C9.65 3 9.39 3.11 9.21 3.29L8.5 4H6C5.45 4 5 4.45 5 5C5 5.55 5.45 6 6 6H18C18.55 6 19 5.55 19 5C19 4.45 18.55 4 18 4Z",fill:t.fillColor},null,8,Ht)])]))}}),Ft={key:0,class:"image-wrapper"},Rt=["src"],Ot={key:1,class:"file-icon"},jt={class:"filename"},Wt=["onClick"],Zt=y({__name:"FilePreview",props:{files:{},direction:{},needCloseButton:{type:Boolean}},emits:["delete"],setup(f,{emit:t}){const s=f,a=t,r=C(()=>s.direction==="vertical");function v(l){return l.type.startsWith("image/")}function c(l){return URL.createObjectURL(l)}function h(l){a("delete",l)}return(l,d)=>(n(),i("div",{class:T(["file-preview-container",{"is-vertical":r.value}])},[(n(!0),i(S,null,z(l.files,(u,g)=>(n(),i("div",{key:g,class:"file-item"},[v(u)?(n(),i("div",Ft,[e("img",{src:c(u),class:"image-preview"},null,8,Rt)])):(n(),i("div",Ot,d[0]||(d[0]=[e("span",{class:"icon"},"ðŸ“„",-1)]))),e("div",jt,w(u.name),1),l.needCloseButton?(n(),i("button",{key:2,class:"delete-button",onClick:b=>h(g)},[m(Nt,{class:"delete-icon","fill-color":"white",size:"50%"})],8,Wt)):M("",!0)]))),128))],2))}}),Et=I(Zt,[["__scopeId","data-v-609c527a"]]),qt=["width","height"],Gt=["fill"],Kt=y({__name:"Download",props:{fillColor:{},size:{}},setup(f){return(t,s)=>(n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",width:t.size,height:t.size},[e("path",{d:"M11.59 6H10V1C10 0.45 9.55 0 9 0H5C4.45 0 4 0.45 4 1V6H2.41C1.52 6 1.07 7.08 1.7 7.71L6.29 12.3C6.68 12.69 7.31 12.69 7.7 12.3L12.29 7.71C12.92 7.08 12.48 6 11.59 6ZM0 16C0 16.55 0.45 17 1 17H13C13.55 17 14 16.55 14 16C14 15.45 13.55 15 13 15H1C0.45 15 0 15.45 0 16Z",fill:t.fillColor},null,8,Gt)],8,qt))}}),Jt={key:0,class:"image-wrapper"},Qt=["src"],Xt={key:1,class:"file-icon"},Yt={class:"filename"},es=["onClick"],ts=y({__name:"MessageFilePreview",props:{files:{},direction:{}},setup(f){const t=new q("https://dotflopp.ru/api"),s=f,a=C(()=>s.direction==="vertical"),r=C(()=>s.files.map((l,d)=>{const u=c.value[d];return{...l,previewUrl:u?URL.createObjectURL(u):null,name:u?u.name:l.id}}));function v(l){return l.mediaType.startsWith("image/")}const c=$([]);function h(l){const d=c.value[l];if(!d)return;const u=document.createElement("a");u.href=URL.createObjectURL(d),u.download=d.name,document.body.appendChild(u),u.click(),document.body.removeChild(u)}return Y(async()=>{if(!s.files||s.files.length===0)return;const l=s.files.map(d=>t.getFileAttachment(d.sourceUrl));try{const d=await Promise.all(l);c.value=d}catch(d){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð¾Ð²:",d)}}),ee(()=>{if(c.value.length>0)for(const l of c.value)URL.revokeObjectURL(l)}),(l,d)=>(n(),i("div",{class:T(["file-preview-container",{"is-vertical":a.value}])},[(n(!0),i(S,null,z(r.value,(u,g)=>(n(),i("div",{key:u.id,class:"file-item"},[v(u)?(n(),i("div",Jt,[e("img",{src:u.previewUrl,class:"image-preview"},null,8,Qt)])):(n(),i("div",Xt,d[0]||(d[0]=[e("span",{class:"icon"},"ðŸ“„",-1)]))),e("div",Yt,w(u.name),1),e("button",{class:"download-button",onClick:b=>h(g)},[m(Kt,{class:"download-icon","fill-color":"white",size:"60%"})],8,es)]))),128))],2))}}),ss=I(ts,[["__scopeId","data-v-4ea6c9f5"]]),ns={class:"message-avatars"},os={class:"message-content"},as={class:"message-header"},ls={class:"username"},is={class:"timestamp"},rs={class:"message-body"},cs={class:"files"},us={class:"message-container"},ds={class:"file-preview"},vs=["onKeydown"],_s=y({__name:"Chat",setup(f){const t=ae(),s=O(),a=$([]),r=$(),v=C(()=>s.activeChannelId),c=C(()=>t.getMessages),h=C(()=>t.getUsers),l=$(null),d=$("");$();const u=le("CGW");async function g(_){t.addMessage(_),await re(),H()}function b(_){var p;const o=(p=_.clipboardData)==null?void 0:p.items;if(o)for(let k=0;k<o.length;k++){const U=o[k];if(U.type.indexOf("image")!==-1||U.type==="text/plain"||U.type==="application/pdf"){const L=U.getAsFile();L&&a.value.push(L)}}}function A(_){var o;if(_.preventDefault(),(o=_.dataTransfer)!=null&&o.files&&_.dataTransfer.files.length>0){const p=Array.from(_.dataTransfer.files);a.value.push(...p)}}Y(async()=>{await t.fetchMessages(v.value),H(),u.on("MessageCreated",g)}),ee(()=>{u.off("MessageCreated",g)});async function B(){try{await t.sendMessage(v.value,d.value,a.value),d.value="",a.value=[]}catch(_){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ:",_)}}function H(){l.value&&l.value.scrollTo({top:l.value.scrollHeight,behavior:"smooth"})}function j(){r.value&&r.value.click()}function W(_){console.log("ÐºÐ»Ð¸ÐºÐ°ÑŽ");const o=_.target;o.files&&o.files.length>0&&(a.value=[...a.value,...Array.from(o.files)])}function Z(_){a.value.splice(_,1)}return(_,o)=>{var p;return n(),i(S,null,[e("section",{class:"chat-area",ref_key:"chatContainer",ref:l},[(n(!0),i(S,null,z(c.value,k=>{var U,L;return n(),i("div",{key:k.id,class:"message"},[e("div",ns,[m(G,{name:h.value[k.userId].nickname,avatar:h.value[k.userId].avatar},null,8,["name","avatar"])]),e("div",os,[e("div",as,[e("span",ls,w((U=h.value[k.userId])==null?void 0:U.nickname),1),e("span",is,w(X(ue)(k.createdAt)),1)]),e("div",rs,w(k.text),1),e("div",cs,[((L=k.attachments)==null?void 0:L.length)>0?(n(),V(ss,{key:0,files:k.attachments,direction:"vertical","need-close-button":!1},null,8,["files"])):M("",!0)])])])}),128))],512),e("div",us,[e("div",ds,[((p=a.value)==null?void 0:p.length)>0?(n(),V(Et,{key:0,files:a.value,direction:"horizontal","need-close-button":!0,onDelete:Z},null,8,["files"])):M("",!0)]),e("footer",{class:"message-input",onPaste:b,onDragover:o[2]||(o[2]=P(()=>{},["prevent"])),onDrop:A},[e("div",{class:"clipicon-wrapper",onClick:o[0]||(o[0]=k=>j())},[m(Lt,{"fill-color":"white",size:"55%",class:"clipicon"})]),e("input",{type:"file",accept:"image/*, .pdf, .txt",onChange:W,ref_key:"fileInput",ref:r,hidden:"",multiple:""},null,544),D(e("input",{type:"text",placeholder:"Type a message...","onUpdate:modelValue":o[1]||(o[1]=k=>d.value=k),onKeydown:ie(P(B,["prevent"]),["enter"])},null,40,vs),[[N,d.value]]),e("button",{class:"send-button",onClick:B},"Send")],32)])],64)}}}),ms=I(_s,[["__scopeId","data-v-2b4db4b0"]]),ps={class:"sidebar-users"},fs={class:"user-list"},hs={class:"user-avatar"},Cs={class:"user-name"},gs=y({__name:"MembersSidebar",setup(f){const t=O(),s=C(()=>t.getCommunityMembers);return(a,r)=>(n(),i("div",ps,[r[0]||(r[0]=e("div",{class:"top-bar"},null,-1)),e("ul",fs,[(n(!0),i(S,null,z(s.value,v=>(n(),i("li",{key:v.userId,class:"user-item"},[e("div",hs,[m(K,{name:v.nickname,avatar:v.avatar,status:v.status},null,8,["name","avatar","status"])]),e("span",Cs,w(v.nickname),1)]))),128))])]))}}),$s=I(gs,[["__scopeId","data-v-18c0f87e"]]),ws={class:"app-container"},ys={class:"sidebar"},bs={class:"main-content"},ks={class:"profile"},Is={class:"main-content"},Ms={class:"community-member"},zs=y({__name:"MainPage",setup(f){return(t,s)=>(n(),i("div",ws,[m(ot),e("div",ys,[e("div",bs,[m(It)]),e("div",ks,[m(Ge)])]),e("main",Is,[m(Dt),m(ms)]),e("div",Ms,[m($s)])]))}});export{zs as default};
