import{d as $,j as o,q as N,g as V,c as i,f as u,a as e,t as p,s as Y,T as G,w as T,e as x,l as m,n as L,u as A,r as _,b as z,x as K,k as E,p as O,F as U,y as ee,z as B,A as W,v as D,R,i as te,B as se,C as ne,D as oe,o as ae,E as le,G as ie}from"./index-LmVmsa4I.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as Z,f as j}from"./formatedTime-Cmxrs9xQ.js";import{a as re,_ as ce}from"./phone-XeyzPViJ.js";const ue={class:"modal-content"},de={class:"modal-header"},ve={class:"modal-body"},_e=$({__name:"ModalWindow",props:{show:{type:Boolean},title:{}},emits:["close"],setup(h,{emit:t}){const s=t;function a(){s("close")}return(n,r)=>(o(),N(G,{name:"fade"},{default:V(()=>[n.show?(o(),i("div",{key:0,class:"modal-overlay",onClick:T(a,["self"])},[u(G,{name:"slide"},{default:V(()=>[e("div",ue,[e("div",de,[e("h2",null,p(n.title),1),e("button",{onClick:a,class:"close-btn"},"×")]),e("div",ve,[Y(n.$slots,"default",{},void 0,!0)])])]),_:3})])):x("",!0)]),_:3}))}}),F=b(_e,[["__scopeId","data-v-1b0bf03f"]]),me={class:"avatar-container"},pe=$({__name:"AvatarWithStatus",props:{avatar:{},name:{},status:{}},setup(h){const t=h,s=m(()=>t.avatar),a=m(()=>t.name),n=m(()=>t.status);return(r,c)=>(o(),i("div",me,[u(Z,{name:a.value,avatar:s.value,class:"profile-avatar"},null,8,["name","avatar"]),e("span",{class:L(["status-dot",[n.value==="Online"?"online":n.value==="DoNotDisturb"?"dnd":"invisible"]])},null,2)]))}}),H=b(pe,[["__scopeId","data-v-b56f0ac9"]]),he={class:"user-profile-top"},fe={class:"user-info-top"},Ce={class:"avatar"},ge={class:"user-names"},$e={class:"status-section"},ye={class:"user-info"},we={key:0},be=$({__name:"UserProfile",setup(h){const t=A(),s=m(()=>t.currentUser),a=_(t.currentUser.selectedStatus);function n(){a.value&&t.setStatus(a.value)}return(r,c)=>(o(),i("div",he,[e("div",fe,[e("div",Ce,[u(H,{avatar:s.value.avatar,name:s.value.identityName,status:s.value.selectedStatus},null,8,["avatar","name","status"])]),e("div",ge,[e("h2",null,p(s.value.nickname)+" @"+p(s.value.identityName),1),e("div",$e,[z(e("select",{"onUpdate:modelValue":c[0]||(c[0]=v=>a.value=v),onChange:c[1]||(c[1]=v=>n()),class:"status-select"},c[2]||(c[2]=[e("option",{value:"Online"},"Online",-1),e("option",{value:"DoNotDisturb"},"Don't disturb",-1),e("option",{value:"Invisible"},"Invisible",-1)]),544),[[K,a.value]])])])]),e("div",ye,[e("p",null,[c[3]||(c[3]=e("strong",null,"Last change:",-1)),E(" "+p(O(j)(s.value.credentialsChangeDate)),1)]),e("p",null,[c[4]||(c[4]=e("strong",null,"Email:",-1)),E(" "+p(s.value.email),1)]),s.value.description?(o(),i("p",we,[c[5]||(c[5]=e("strong",null,"About",-1)),E(" "+p(s.value.description),1)])):x("",!0)])]))}}),ke=b(be,[["__scopeId","data-v-234c5043"]]),Ie={};function Se(h,t){return null}const Me=b(Ie,[["render",Se]]),xe={class:"logout-section"},Ve=$({__name:"Logout",setup(h){const t=A();function s(){t.logout(),ee.push("/login")}return(a,n)=>(o(),i(U,null,[n[1]||(n[1]=e("p",null,[e("strong",null,"Do you want to log out of your account?")],-1)),e("div",null,[e("div",xe,[e("button",{class:"logout-button",onClick:n[0]||(n[0]=r=>s())},"Logout")])])],64))}}),Ue=b(Ve,[["__scopeId","data-v-12e857ec"]]),ze={class:"user-card"},Ne={class:"settings-container"},Te={class:"settings-menu"},Ae=["onClick"],Be={class:"content-container"},Pe={class:"settings-content"},De=$({__name:"UserView",setup(h){const t=A();m(()=>t.currentUser);const s=["Profile","Settings","Logout"],a=_(s[0]);function n(r){a.value=r}return(r,c)=>(o(),i("div",ze,[e("div",Ne,[e("aside",Te,[e("ul",null,[(o(),i(U,null,B(s,(v,d)=>e("li",{key:d},[e("button",{class:L({active:a.value===v}),onClick:w=>n(v)},p(v),11,Ae)])),64))])])]),e("div",Be,[e("main",Pe,[a.value==="Profile"?(o(),N(ke,{key:0})):a.value==="Settings"?(o(),N(Me,{key:1})):a.value==="Logout"?(o(),N(Ue,{key:2})):x("",!0)])])]))}}),Fe=b(De,[["__scopeId","data-v-327a5efd"]]),Le={class:"profile-widget"},We={class:"avatar"},qe={class:"profile-info"},Ee={class:"username"},He={class:"user-tag"},Ge=$({__name:"ProfileCard",setup(h){const t=A(),s=m(()=>t.currentUser.avatar),a=m(()=>t.currentUser.nickname),n=m(()=>t.currentUser.identityName),r=m(()=>t.currentUser.selectedStatus),c=_(!1);return(v,d)=>(o(),i("div",Le,[e("div",We,[u(H,{avatar:s.value,name:a.value,status:r.value},null,8,["avatar","name","status"])]),e("div",qe,[e("div",Ee,p(a.value),1),e("div",He,"@"+p(n.value),1)]),e("button",{class:"settings-button",onClick:d[0]||(d[0]=w=>c.value=!0)},d[2]||(d[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",class:"settings-icon"},[e("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.5-.03-.62.19l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.5.03.62-.19l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})],-1)])),u(F,{show:c.value,title:"User Environment",onClose:d[1]||(d[1]=w=>c.value=!1)},{default:V(()=>[u(Fe)]),_:1},8,["show"])]))}}),Ke=b(Ge,[["__scopeId","data-v-63379543"]]),Oe=["width","height"],Re=["fill"],J=$({__name:"CreateIcon",props:{fillColor:{},size:{}},setup(h){return(t,s)=>(o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z",fill:t.fillColor},null,8,Re)],8,Oe))}}),Ze={class:"sidebar-communities"},je={class:"community-list"},Je=["onClick"],Qe={class:"community-avatar"},Xe={class:"add-community-button"},Ye={key:0,class:"success-message"},et=$({__name:"CommunitySidebar",setup(h){const t=new R("https://dotflopp.ru/api"),s=W(),a=_(!1),n=_(""),r=_(""),c=m(()=>s.communities),v=m(()=>s.activeCommunityId);function d(y){s.setActiveCommunity(y)}async function w(){if(n.value.trim())try{const y=await t.createNewCommunities(n.value);s.addCommunity(y),r.value="Сообщество успешно создано!"}catch(y){console.error("Ошибка при создании сообщества:",y),r.value="Не удалось создать сообщество."}}return(y,f)=>(o(),i("div",Ze,[e("ul",je,[(o(!0),i(U,null,B(c.value,C=>(o(),i("li",{key:C.id,class:L(["community-item",{active:C.id===v.value}]),onClick:P=>d(C.id)},[e("div",Qe,[C.avatar?x("",!0):(o(),N(Z,{key:0,name:C.name,avatar:C.avatar},null,8,["name","avatar"]))])],10,Je))),128))]),e("div",Xe,[e("button",{class:"add-btn",onClick:f[0]||(f[0]=C=>a.value=!0)},[u(J,{fillColor:"white",size:"70%"})]),u(F,{show:a.value,title:"Creating Community",onClose:f[2]||(f[2]=C=>a.value=!1)},{default:V(()=>[e("form",{onSubmit:T(w,["prevent"]),class:"community-form"},[z(e("input",{id:"community-name","onUpdate:modelValue":f[1]||(f[1]=C=>n.value=C),type:"text",placeholder:"community name",required:""},null,512),[[D,n.value]]),r.value?(o(),i("p",Ye,p(r.value),1)):x("",!0),f[3]||(f[3]=e("button",{type:"submit",class:"create-button"},"Create",-1))],32)]),_:1},8,["show"])])]))}}),tt=b(et,[["__scopeId","data-v-fc60142f"]]),st={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"},nt={"clip-path":"url(#clip0_2311_9433)"},ot=["fill"],at=$({__name:"PersonIcon",props:{fillColor:{}},setup(h){return(t,s)=>(o(),i("svg",st,[e("g",nt,[e("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V19C4 19.55 4.45 20 5 20H19C19.55 20 20 19.55 20 19V18C20 15.34 14.67 14 12 14Z",fill:t.fillColor},null,8,ot)])]))}}),lt={key:0,class:"sidebar-content"},it={class:"current-communities"},rt={class:"community-card"},ct={class:"community-name"},ut={key:0,class:"message"},dt={class:"sidebar-channels"},vt={class:"channel-list"},_t=["onClick"],mt={class:"channel"},pt={class:"channel-name"},ht=["onClick"],ft={class:"add-channel-button"},Ct={class:"channel-type"},gt={class:"status-section"},$t={key:0,class:"message"},yt=$({__name:"ChannelSidebar",setup(h){const t=new R("https://dotflopp.ru/api"),s=W(),a=_(!1),n=_(""),r=_(""),c=_(!1),v=_(""),d=_("TextChannel"),w=_(""),y=m(()=>s.activeCommunityId),f=_("0"),C=m(()=>y.value?s.getCommunityById(y.value):null),P=m(()=>s.channels),q=m(()=>s.activeChannelId);function S(k){s.setActiveChannel(k)}async function I(){if(n.value.trim())try{const l=`https://dotflopp.ru/invite/${(await t.createInvitation(s.getactiveCommunityId,n.value)).id}`;await navigator.clipboard.writeText(l),r.value="Invitation copied to clipboard"}catch(k){console.error("Ошибка при создании приглашения:",k),r.value="Не удалось создать приглашение."}}async function M(){if(!(!v.value.trim()||d.value.length==0))try{const k={name:v.value,type:d.value,parentId:f.value},l=await t.createNewChannel(y.value,k);console.log(l),s.addChannel(l),w.value="Канал успешно создан!",f.value="0"}catch(k){console.error("Ошибка при создании канала:",k),w.value="Не удалось создать канал."}}function Q(k){f.value=k}return(k,l)=>C.value?(o(),i("div",lt,[e("div",it,[e("div",rt,[e("div",ct,p(C.value.name),1),e("button",{class:"addPerson-btn",onClick:l[0]||(l[0]=g=>a.value=!0)},[u(at,{class:"addPerson",fillColor:"white"})]),u(F,{show:a.value,title:"Create Invitation",onClose:l[2]||(l[2]=g=>a.value=!1)},{default:V(()=>[e("form",{onSubmit:T(I,["prevent"]),class:"invitation-form"},[z(e("input",{id:"lifetime","onUpdate:modelValue":l[1]||(l[1]=g=>n.value=g),type:"text",placeholder:"Seconds",required:""},null,512),[[D,n.value]]),r.value?(o(),i("p",ut,p(r.value),1)):x("",!0),l[7]||(l[7]=e("button",{type:"submit",class:"create-button"},"Create Invitation",-1))],32)]),_:1},8,["show"])])]),e("div",dt,[e("ul",vt,[(o(!0),i(U,null,B(P.value,g=>(o(),i("li",{key:g.id,class:L(["channel-item",{active:g.id===q.value}]),onClick:X=>S(g.id)},[e("div",mt,[e("div",pt,p(g.name),1),e("button",{class:"addChannel-btn-simple",onClick:X=>(c.value=!0,Q(g.id))},[u(J,{fillColor:"white",size:"100%"})],8,ht)])],10,_t))),128))]),e("div",ft,[e("button",{class:"addChannel-btn",onClick:l[3]||(l[3]=g=>c.value=!0)},l[8]||(l[8]=[e("p",null,"create channel",-1)]))]),u(F,{show:c.value,title:"Create channel",onClose:l[6]||(l[6]=g=>c.value=!1)},{default:V(()=>[e("form",{onSubmit:T(M,["prevent"]),class:"invitation-form"},[z(e("input",{id:"channelName","onUpdate:modelValue":l[4]||(l[4]=g=>v.value=g),type:"text",placeholder:"channel name",required:""},null,512),[[D,v.value]]),e("div",Ct,[l[10]||(l[10]=e("p",null,"Channel type",-1)),e("div",gt,[z(e("select",{"onUpdate:modelValue":l[5]||(l[5]=g=>d.value=g),class:"channeltype-select"},l[9]||(l[9]=[e("option",{value:"TextChannel"},"TextChannel",-1),e("option",{value:"ForkChannel"},"ForkChannel",-1),e("option",{value:"VoiceChannel"},"VoiceChannel",-1),e("option",{value:"CategoryChannel"},"CategoryChannel",-1)]),512),[[K,d.value]])])]),w.value?(o(),i("p",$t,p(w.value),1)):x("",!0),l[11]||(l[11]=e("button",{type:"submit",class:"create-button"},"Create Channel",-1))],32)]),_:1},8,["show"])])])):x("",!0)}}),wt=b(yt,[["__scopeId","data-v-8198e01f"]]),bt={},kt={class:"top-bar"},It={class:"call-icons"},St={class:"call-icon",id:"phone-btn"},Mt={class:"call-icon",id:"camera-btn"};function xt(h,t){const s=te("router-link");return o(),i("header",kt,[t[2]||(t[2]=e("div",{class:"server-name"},"Chat",-1)),e("div",It,[e("button",St,[u(s,{to:"/rooms"},{default:V(()=>t[0]||(t[0]=[e("img",{src:re},null,-1)])),_:1})]),e("button",Mt,[u(s,{to:"/rooms"},{default:V(()=>t[1]||(t[1]=[e("img",{src:ce},null,-1)])),_:1})])])])}const Vt=b(bt,[["render",xt],["__scopeId","data-v-75814ce4"]]),Ut=["width","height"],zt=["fill"],Nt=$({__name:"СlipIcon",props:{fillColor:{},size:{}},setup(h){return(t,s)=>(o(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M16.5 6.75015V17.3301C16.5 19.4201 14.97 21.2801 12.89 21.4801C10.5 21.7101 8.5 19.8401 8.5 17.5001V5.14015C8.5 3.83015 9.44 2.64015 10.74 2.51015C12.24 2.36015 13.5 3.53015 13.5 5.00015V15.5001C13.5 16.0501 13.05 16.5001 12.5 16.5001C11.95 16.5001 11.5 16.0501 11.5 15.5001V6.75015C11.5 6.34015 11.16 6.00015 10.75 6.00015C10.34 6.00015 10 6.34015 10 6.75015V15.3601C10 16.6701 10.94 17.8601 12.24 17.9901C13.74 18.1401 15 16.9701 15 15.5001V5.17015C15 3.08015 13.47 1.22015 11.39 1.02015C9.01 0.790146 7 2.66015 7 5.00015V17.2701C7 20.1401 9.1 22.7101 11.96 22.9801C15.25 23.2801 18 20.7201 18 17.5001V6.75015C18 6.34015 17.66 6.00015 17.25 6.00015C16.84 6.00015 16.5 6.34015 16.5 6.75015Z",fill:t.fillColor},null,8,zt)],8,Ut))}}),Tt={class:"message-content"},At={class:"message-header"},Bt={class:"timestamp"},Pt={class:"message-body"},Dt={class:"message-input"},Ft=["disabled"],Lt=["onKeydown"],Wt=$({__name:"Chat",setup(h){const t=se(),s=W();A();const a=_(null),n=_();ne();const r=m(()=>s.activeChannelId),c=m(()=>t.getMessages),v=_(null),d=_("");_();const w=oe("CGW");function y(S){t.addMessage(S),C()}ae(()=>{t.fetchMessages(r.value),w.on("MessageCreated",y)}),le(()=>{w.off("MessageCreated",y)});async function f(){if(d.value.trim())try{await t.sendMessage(r.value,d.value),d.value=""}catch(S){console.error("Ошибка отправки сообщения:",S)}}function C(){v.value&&(v.value.scrollTop=v.value.scrollHeight)}function P(){n.value&&n.value.click()}function q(S){console.log("кликаю");const I=S.target;I.files&&I.files.length>0&&(a.value=I.files[0])}return(S,I)=>(o(),i(U,null,[e("section",{class:"chat-area",ref_key:"chatContainer",ref:v},[(o(!0),i(U,null,B(c.value,M=>(o(),i("div",{key:M.id,class:"message"},[e("div",Tt,[e("div",At,[e("span",Bt,p(O(j)(M.createdAt)),1)]),e("div",Pt,p(M.text),1)])]))),128))],512),e("footer",Dt,[e("div",{class:"clipicon-wrapper",onClick:I[0]||(I[0]=M=>P()),disabled:!a.value},[u(Nt,{"fill-color":"white",size:"55%",class:"clipicon"})],8,Ft),e("input",{type:"file",accept:"image/*, .pdf, .txt",onChange:q,ref_key:"fileInput",ref:n,hidden:""},null,544),z(e("input",{type:"text",placeholder:"Type a message...","onUpdate:modelValue":I[1]||(I[1]=M=>d.value=M),onKeydown:ie(T(f,["prevent"]),["enter"])},null,40,Lt),[[D,d.value]]),e("button",{class:"send-button",onClick:f},"Send")])],64))}}),qt=b(Wt,[["__scopeId","data-v-dce6d089"]]),Et={class:"sidebar-users"},Ht={class:"user-list"},Gt={class:"user-avatar"},Kt={class:"user-name"},Ot=$({__name:"MembersSidebar",setup(h){const t=W(),s=m(()=>t.getCommunityMembers);return(a,n)=>(o(),i("div",Et,[n[0]||(n[0]=e("div",{class:"top-bar"},null,-1)),e("ul",Ht,[(o(!0),i(U,null,B(s.value,r=>(o(),i("li",{key:r.userId,class:"user-item"},[e("div",Gt,[u(H,{name:r.nickname,avatar:r.avatar,status:r.status},null,8,["name","avatar","status"])]),e("span",Kt,p(r.nickname),1)]))),128))])]))}}),Rt=b(Ot,[["__scopeId","data-v-ac7d5319"]]),Zt={class:"app-container"},jt={class:"sidebar"},Jt={class:"main-content"},Qt={class:"profile"},Xt={class:"main-content"},Yt={class:"community-member"},os=$({__name:"MainPage",setup(h){return(t,s)=>(o(),i("div",Zt,[u(tt),e("div",jt,[e("div",Jt,[u(wt)]),e("div",Qt,[u(Ke)])]),e("main",Xt,[u(Vt),u(qt)]),e("div",Yt,[u(Rt)])]))}});export{os as default};
