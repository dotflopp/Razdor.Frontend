import{d as y,j as n,s as T,g as x,c as l,f as m,a as e,t as g,x as ne,T as X,w as z,e as S,l as C,n as L,u as O,r as w,b as D,y as Y,k as q,q as A,z as G,F as M,A as oe,B as V,m as j,v as F,R as K,i as ae,o as ee,C as te,D as le,E as ie,G as re}from"./index-ByIF6zXJ.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as J,f as ce,a as ue}from"./formatedTime-Bjj6gUXZ.js";import{a as de,_ as ve}from"./phone-XeyzPViJ.js";const _e={class:"modal-content"},me={class:"modal-header"},pe={class:"modal-body"},fe=y({__name:"ModalWindow",props:{show:{type:Boolean},title:{}},emits:["close"],setup(f,{emit:t}){const s=t;function a(){s("close")}return(i,u)=>(n(),T(X,{name:"fade"},{default:x(()=>[i.show?(n(),l("div",{key:0,class:"modal-overlay",onClick:z(a,["self"])},[m(X,{name:"slide"},{default:x(()=>[e("div",_e,[e("div",me,[e("h2",null,g(i.title),1),e("button",{onClick:a,class:"close-btn"},"Ã—")]),e("div",pe,[ne(i.$slots,"default",{},void 0,!0)])])]),_:3})])):S("",!0)]),_:3}))}}),R=I(fe,[["__scopeId","data-v-1b0bf03f"]]),he={class:"avatar-container"},Ce=y({__name:"AvatarWithStatus",props:{avatar:{},name:{},status:{}},setup(f){const t=f,s=C(()=>t.avatar),a=C(()=>t.name),i=C(()=>t.status);return(u,c)=>(n(),l("div",he,[m(J,{name:a.value,avatar:s.value,class:"profile-avatar"},null,8,["name","avatar"]),e("span",{class:L(["status-dot",[i.value==="Online"?"online":i.value==="DoNotDisturb"?"dnd":"invisible"]])},null,2)]))}}),Q=I(Ce,[["__scopeId","data-v-b56f0ac9"]]),ge={class:"user-profile-top"},$e={class:"user-info-top"},we={class:"avatar"},ye={class:"user-names"},be={class:"status-section"},ke={class:"user-info"},Ie={key:0},Se=y({__name:"UserProfile",setup(f){const t=O(),s=C(()=>t.currentUser),a=w(t.currentUser.selectedStatus);function i(){a.value&&t.setStatus(a.value)}return(u,c)=>(n(),l("div",ge,[e("div",$e,[e("div",we,[m(Q,{avatar:s.value.avatar,name:s.value.identityName,status:s.value.selectedStatus},null,8,["avatar","name","status"])]),e("div",ye,[e("h2",null,g(s.value.nickname)+" @"+g(s.value.identityName),1),e("div",be,[D(e("select",{"onUpdate:modelValue":c[0]||(c[0]=h=>a.value=h),onChange:c[1]||(c[1]=h=>i()),class:"status-select"},c[2]||(c[2]=[e("option",{value:"Online"},"Online",-1),e("option",{value:"DoNotDisturb"},"Don't disturb",-1),e("option",{value:"Invisible"},"Invisible",-1)]),544),[[Y,a.value]])])])]),e("div",ke,[e("p",null,[c[3]||(c[3]=e("strong",null,"Last change:",-1)),q(" "+g(A(ce)(s.value.credentialsChangeDate)),1)]),e("p",null,[c[4]||(c[4]=e("strong",null,"Email:",-1)),q(" "+g(s.value.email),1)]),s.value.description?(n(),l("p",Ie,[c[5]||(c[5]=e("strong",null,"About",-1)),q(" "+g(s.value.description),1)])):S("",!0)])]))}}),Me=I(Se,[["__scopeId","data-v-d02b481b"]]),xe=y({__name:"UserSettings",setup(f){const t=G("theme"),s=G("toggleTheme");return(a,i)=>(n(),l("button",{onClick:i[0]||(i[0]=(...u)=>A(s)&&A(s)(...u)),class:"theme-toggle"},g(A(t)==="dark"?"Switch to Light Theme":"Switch to Dark Theme"),1))}}),Ue={class:"logout-section"},Ve=y({__name:"Logout",setup(f){const t=O();function s(){t.logout(),oe.push("/login")}return(a,i)=>(n(),l(M,null,[i[1]||(i[1]=e("p",null,[e("strong",null,"Do you want to log out of your account?")],-1)),e("div",null,[e("div",Ue,[e("button",{class:"logout-button",onClick:i[0]||(i[0]=u=>s())},"Logout")])])],64))}}),Te=I(Ve,[["__scopeId","data-v-12e857ec"]]),De={class:"user-card"},ze={class:"settings-container"},Le={class:"settings-menu"},Pe=["onClick"],Ae={class:"content-container"},Be={class:"settings-content"},He=y({__name:"UserView",setup(f){const t=O();C(()=>t.currentUser);const s=["Profile","Settings","Logout"],a=w(s[0]);function i(u){a.value=u}return(u,c)=>(n(),l("div",De,[e("div",ze,[e("aside",Le,[e("ul",null,[(n(),l(M,null,V(s,(h,r)=>e("li",{key:r},[e("button",{class:L({active:a.value===h}),onClick:v=>i(h)},g(h),11,Pe)])),64))])])]),e("div",Ae,[e("main",Be,[a.value==="Profile"?(n(),T(Me,{key:0})):a.value==="Settings"?(n(),T(xe,{key:1})):a.value==="Logout"?(n(),T(Te,{key:2})):S("",!0)])])]))}}),Ne=I(He,[["__scopeId","data-v-327a5efd"]]),Fe={class:"profile-widget"},Re={class:"avatar"},Oe={class:"profile-info"},je={class:"username"},We={class:"user-tag"},Ze=y({__name:"ProfileCard",setup(f){const t=O(),s=C(()=>t.currentUser.avatar),a=C(()=>t.currentUser.nickname),i=C(()=>t.currentUser.identityName),u=C(()=>t.currentUser.selectedStatus),c=w(!1);return(h,r)=>(n(),l("div",Fe,[e("div",Re,[m(Q,{avatar:s.value,name:a.value,status:u.value},null,8,["avatar","name","status"])]),e("div",Oe,[e("div",je,g(a.value),1),e("div",We,"@"+g(i.value),1)]),e("button",{class:"settings-button",onClick:r[0]||(r[0]=v=>c.value=!0)},r[2]||(r[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",class:"settings-icon"},[e("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.5-.03-.62.19l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.5.03.62-.19l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})],-1)])),m(R,{show:c.value,title:"User Environment",onClose:r[1]||(r[1]=v=>c.value=!1)},{default:x(()=>[m(Ne)]),_:1},8,["show"])]))}}),Ee=I(Ze,[["__scopeId","data-v-0dea13ad"]]),qe=["width","height"],Ge=["fill"],se=y({__name:"CreateIcon",props:{fillColor:{},size:{}},setup(f){return(t,s)=>(n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z",fill:t.fillColor},null,8,Ge)],8,qe))}}),Ke={class:"sidebar-communities"},Je={class:"community-list"},Qe=["onClick"],Xe={class:"community-avatar"},Ye={class:"add-community-button"},et={key:0,class:"success-message"},tt=y({__name:"CommunitySidebar",setup(f){const t=new K("https://dotflopp.ru/api"),s=j(),a=w(!1),i=w(""),u=w(""),c=C(()=>s.communities),h=C(()=>s.activeCommunityId);function r(d){s.setActiveCommunity(d)}async function v(){if(i.value.trim())try{const d=await t.createNewCommunities(i.value);s.addCommunity(d),u.value="Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½Ð¾!"}catch(d){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð°:",d),u.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð¾."}}return(d,$)=>(n(),l("div",Ke,[e("ul",Je,[(n(!0),l(M,null,V(c.value,k=>(n(),l("li",{key:k.id,class:L(["community-item",{active:k.id===h.value}]),onClick:B=>r(k.id)},[e("div",Xe,[m(J,{name:k.name,avatar:k.avatar},null,8,["name","avatar"])])],10,Qe))),128))]),e("div",Ye,[e("button",{class:"add-btn",onClick:$[0]||($[0]=k=>a.value=!0)},[m(se,{fillColor:"white",size:"70%"})]),m(R,{show:a.value,title:"Creating Community",onClose:$[2]||($[2]=k=>a.value=!1)},{default:x(()=>[e("form",{onSubmit:z(v,["prevent"]),class:"community-form"},[D(e("input",{id:"community-name","onUpdate:modelValue":$[1]||($[1]=k=>i.value=k),type:"text",placeholder:"community name",required:""},null,512),[[F,i.value]]),u.value?(n(),l("p",et,g(u.value),1)):S("",!0),$[3]||($[3]=e("button",{type:"submit",class:"create-button"},"Create",-1))],32)]),_:1},8,["show"])])]))}}),st=I(tt,[["__scopeId","data-v-06b3aaf0"]]),nt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"},ot={"clip-path":"url(#clip0_2311_9433)"},at=["fill"],lt=y({__name:"PersonIcon",props:{fillColor:{}},setup(f){return(t,s)=>(n(),l("svg",nt,[e("g",ot,[e("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V19C4 19.55 4.45 20 5 20H19C19.55 20 20 19.55 20 19V18C20 15.34 14.67 14 12 14Z",fill:t.fillColor},null,8,at)])]))}}),it={key:0,class:"sidebar-content"},rt={class:"current-communities"},ct={class:"community-card"},ut={class:"community-name"},dt={key:0,class:"message"},vt={class:"sidebar-channels"},_t={class:"channel-list"},mt=["onClick"],pt={class:"channel"},ft={class:"channel-name"},ht=["onClick"],Ct={class:"add-channel-button"},gt={class:"channel-type"},$t={class:"status-section"},wt={key:0,class:"message"},yt=y({__name:"ChannelSidebar",setup(f){const t=new K("https://dotflopp.ru/api"),s=j(),a=w(!1),i=w(""),u=w(""),c=w(!1),h=w(""),r=w("TextChannel"),v=w(""),d=C(()=>s.activeCommunityId),$=w("0"),k=C(()=>d.value?s.getCommunityById(d.value):null),B=C(()=>s.channels),H=C(()=>s.activeChannelId);function N(_){s.setActiveChannel(_)}async function W(){if(i.value.trim())try{const o=`https://dotflopp.ru/invite/${(await t.createInvitation(s.getActiveCommunityId,i.value)).id}`;await navigator.clipboard.writeText(o),u.value="Invitation copied to clipboard"}catch(_){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐµÐ½Ð¸Ñ:",_),u.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð³Ð»Ð°ÑˆÐµÐ½Ð¸Ðµ."}}async function Z(){if(!(!h.value.trim()||r.value.length==0))try{const _={name:h.value,type:r.value,parentId:$.value},o=await t.createNewChannel(d.value,_);console.log(o),s.addChannel(o),v.value="ÐšÐ°Ð½Ð°Ð» ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½!",$.value="0"}catch(_){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ ÐºÐ°Ð½Ð°Ð»Ð°:",_),v.value="ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÐºÐ°Ð½Ð°Ð»."}}function E(_){$.value=_}return(_,o)=>k.value?(n(),l("div",it,[e("div",rt,[e("div",ct,[e("div",ut,g(k.value.name),1),e("button",{class:"addPerson-btn",onClick:o[0]||(o[0]=p=>a.value=!0)},[m(lt,{class:"addPerson",fillColor:"white"})]),m(R,{show:a.value,title:"Create Invitation",onClose:o[2]||(o[2]=p=>a.value=!1)},{default:x(()=>[e("form",{onSubmit:z(W,["prevent"]),class:"invitation-form"},[D(e("input",{id:"lifetime","onUpdate:modelValue":o[1]||(o[1]=p=>i.value=p),type:"text",placeholder:"Seconds",required:""},null,512),[[F,i.value]]),u.value?(n(),l("p",dt,g(u.value),1)):S("",!0),o[7]||(o[7]=e("button",{type:"submit",class:"create-button"},"Create Invitation",-1))],32)]),_:1},8,["show"])])]),e("div",vt,[e("ul",_t,[(n(!0),l(M,null,V(B.value,p=>(n(),l("li",{key:p.id,class:L(["channel-item",{active:p.id===H.value}]),onClick:b=>N(p.id)},[e("div",pt,[e("div",ft,g(p.name),1),e("button",{class:"addChannel-btn-simple",onClick:b=>(c.value=!0,E(p.id))},[m(se,{fillColor:"white",size:"100%"})],8,ht)])],10,mt))),128))]),e("div",Ct,[e("button",{class:"addChannel-btn",onClick:o[3]||(o[3]=p=>c.value=!0)},o[8]||(o[8]=[e("p",null,"create channel",-1)]))]),m(R,{show:c.value,title:"Create channel",onClose:o[6]||(o[6]=p=>c.value=!1)},{default:x(()=>[e("form",{onSubmit:z(Z,["prevent"]),class:"invitation-form"},[D(e("input",{id:"channelName","onUpdate:modelValue":o[4]||(o[4]=p=>h.value=p),type:"text",placeholder:"channel name",required:""},null,512),[[F,h.value]]),e("div",gt,[o[10]||(o[10]=e("p",null,"Channel type",-1)),e("div",$t,[D(e("select",{"onUpdate:modelValue":o[5]||(o[5]=p=>r.value=p),class:"channeltype-select"},o[9]||(o[9]=[e("option",{value:"TextChannel"},"TextChannel",-1),e("option",{value:"VoiceChannel"},"VoiceChannel",-1),e("option",{value:"CategoryChannel"},"CategoryChannel",-1)]),512),[[Y,r.value]])])]),v.value?(n(),l("p",wt,g(v.value),1)):S("",!0),o[11]||(o[11]=e("button",{type:"submit",class:"create-button"},"Create Channel",-1))],32)]),_:1},8,["show"])])])):S("",!0)}}),bt=I(yt,[["__scopeId","data-v-b6105b82"]]),kt={},It={class:"top-bar"},St={class:"call-icons"},Mt={class:"call-icon",id:"phone-btn"},xt={class:"call-icon",id:"camera-btn"};function Ut(f,t){const s=ae("router-link");return n(),l("header",It,[t[2]||(t[2]=e("div",{class:"server-name"},"Chat",-1)),e("div",St,[e("button",Mt,[m(s,{to:"/rooms"},{default:x(()=>t[0]||(t[0]=[e("img",{src:de},null,-1)])),_:1})]),e("button",xt,[m(s,{to:"/rooms"},{default:x(()=>t[1]||(t[1]=[e("img",{src:ve},null,-1)])),_:1})])])])}const Vt=I(kt,[["render",Ut],["__scopeId","data-v-d25e99d9"]]),Tt=["width","height"],Dt=["fill"],zt=y({__name:"Ð¡lipIcon",props:{fillColor:{},size:{}},setup(f){return(t,s)=>(n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:t.size,height:t.size},[e("path",{d:"M16.5 6.75015V17.3301C16.5 19.4201 14.97 21.2801 12.89 21.4801C10.5 21.7101 8.5 19.8401 8.5 17.5001V5.14015C8.5 3.83015 9.44 2.64015 10.74 2.51015C12.24 2.36015 13.5 3.53015 13.5 5.00015V15.5001C13.5 16.0501 13.05 16.5001 12.5 16.5001C11.95 16.5001 11.5 16.0501 11.5 15.5001V6.75015C11.5 6.34015 11.16 6.00015 10.75 6.00015C10.34 6.00015 10 6.34015 10 6.75015V15.3601C10 16.6701 10.94 17.8601 12.24 17.9901C13.74 18.1401 15 16.9701 15 15.5001V5.17015C15 3.08015 13.47 1.22015 11.39 1.02015C9.01 0.790146 7 2.66015 7 5.00015V17.2701C7 20.1401 9.1 22.7101 11.96 22.9801C15.25 23.2801 18 20.7201 18 17.5001V6.75015C18 6.34015 17.66 6.00015 17.25 6.00015C16.84 6.00015 16.5 6.34015 16.5 6.75015Z",fill:t.fillColor},null,8,Dt)],8,Tt))}}),Lt={viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Pt={"clip-path":"url(#clip0_2311_5181)"},At=["fill"],Bt=y({__name:"DeleteIcon",props:{fillColor:{}},setup(f){return(t,s)=>(n(),l("svg",Lt,[e("g",Pt,[e("path",{d:"M6 19C6 20.1 6.9 21 8 21H16C17.1 21 18 20.1 18 19V9C18 7.9 17.1 7 16 7H8C6.9 7 6 7.9 6 9V19ZM18 4H15.5L14.79 3.29C14.61 3.11 14.35 3 14.09 3H9.91C9.65 3 9.39 3.11 9.21 3.29L8.5 4H6C5.45 4 5 4.45 5 5C5 5.55 5.45 6 6 6H18C18.55 6 19 5.55 19 5C19 4.45 18.55 4 18 4Z",fill:t.fillColor},null,8,At)])]))}}),Ht={key:0,class:"image-wrapper"},Nt=["src"],Ft={key:1,class:"file-icon"},Rt={class:"filename"},Ot=["onClick"],jt=y({__name:"FilePreview",props:{files:{},direction:{},needCloseButton:{type:Boolean}},emits:["delete"],setup(f,{emit:t}){const s=f,a=t,i=C(()=>s.direction==="vertical");function u(r){return r.type.startsWith("image/")}function c(r){return URL.createObjectURL(r)}function h(r){a("delete",r)}return(r,v)=>(n(),l("div",{class:L(["file-preview-container",{"is-vertical":i.value}])},[(n(!0),l(M,null,V(r.files,(d,$)=>(n(),l("div",{key:$,class:"file-item"},[u(d)?(n(),l("div",Ht,[e("img",{src:c(d),class:"image-preview"},null,8,Nt)])):(n(),l("div",Ft,v[0]||(v[0]=[e("span",{class:"icon"},"ðŸ“„",-1)]))),e("div",Rt,g(d.name),1),r.needCloseButton?(n(),l("button",{key:2,class:"delete-button",onClick:k=>h($)},[m(Bt,{class:"delete-icon","fill-color":"white",size:"50%"})],8,Ot)):S("",!0)]))),128))],2))}}),Wt=I(jt,[["__scopeId","data-v-609c527a"]]),Zt=["width","height"],Et=["fill"],qt=y({__name:"Download",props:{fillColor:{},size:{}},setup(f){return(t,s)=>(n(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",width:t.size,height:t.size},[e("path",{d:"M11.59 6H10V1C10 0.45 9.55 0 9 0H5C4.45 0 4 0.45 4 1V6H2.41C1.52 6 1.07 7.08 1.7 7.71L6.29 12.3C6.68 12.69 7.31 12.69 7.7 12.3L12.29 7.71C12.92 7.08 12.48 6 11.59 6ZM0 16C0 16.55 0.45 17 1 17H13C13.55 17 14 16.55 14 16C14 15.45 13.55 15 13 15H1C0.45 15 0 15.45 0 16Z",fill:t.fillColor},null,8,Et)],8,Zt))}}),Gt={key:0,class:"image-wrapper"},Kt=["src"],Jt={key:1,class:"file-icon"},Qt={class:"filename"},Xt=["onClick"],Yt=y({__name:"MessageFilePreview",props:{files:{},direction:{}},setup(f){const t=new K("https://dotflopp.ru/api"),s=f,a=C(()=>s.direction==="vertical"),i=C(()=>s.files.map((r,v)=>{const d=c.value[v];return{...r,previewUrl:d?URL.createObjectURL(d):null,name:d?d.name:r.id}}));function u(r){return r.mediaType.startsWith("image/")}const c=w([]);function h(r){const v=c.value[r];if(!v)return;const d=document.createElement("a");d.href=URL.createObjectURL(v),d.download=v.name,document.body.appendChild(d),d.click(),document.body.removeChild(d)}return ee(async()=>{if(!s.files||s.files.length===0)return;const r=s.files.map(v=>t.getFileAttachment(v.sourceUrl));try{const v=await Promise.all(r);c.value=v}catch(v){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð¾Ð²:",v)}}),te(()=>{if(c.value.length>0)for(const r of c.value)URL.revokeObjectURL(r)}),(r,v)=>(n(),l("div",{class:L(["file-preview-container",{"is-vertical":a.value}])},[(n(!0),l(M,null,V(i.value,(d,$)=>(n(),l("div",{key:d.id,class:"file-item"},[u(d)?(n(),l("div",Gt,[e("img",{src:d.previewUrl,class:"image-preview"},null,8,Kt)])):(n(),l("div",Jt,v[0]||(v[0]=[e("span",{class:"icon"},"ðŸ“„",-1)]))),e("div",Qt,g(d.name),1),e("button",{class:"download-button",onClick:k=>h($)},[m(qt,{class:"download-icon","fill-color":"white",size:"60%"})],8,Xt)]))),128))],2))}}),es=I(Yt,[["__scopeId","data-v-4ea6c9f5"]]),ts={class:"message-avatars"},ss={class:"message-content"},ns={class:"message-header"},os={class:"username"},as={class:"timestamp"},ls={class:"message-body"},is={class:"files"},rs={class:"message-container"},cs={class:"file-preview"},us=["onKeydown"],ds=y({__name:"Chat",setup(f){const t=le(),s=j(),a=w([]),i=w(),u=C(()=>s.activeChannelId),c=C(()=>t.getMessages),h=C(()=>t.getUsers),r=w(null),v=w("");w();const d=G("CGW");async function $(_){t.addMessage(_),await re(),N()}function k(_){var p;const o=(p=_.clipboardData)==null?void 0:p.items;if(o)for(let b=0;b<o.length;b++){const U=o[b];if(U.type.indexOf("image")!==-1||U.type==="text/plain"||U.type==="application/pdf"){const P=U.getAsFile();P&&a.value.push(P)}}}function B(_){var o;if(_.preventDefault(),(o=_.dataTransfer)!=null&&o.files&&_.dataTransfer.files.length>0){const p=Array.from(_.dataTransfer.files);a.value.push(...p)}}ee(async()=>{await t.fetchMessages(u.value),N(),d.on("MessageCreated",$)}),te(()=>{d.off("MessageCreated",$)});async function H(){try{await t.sendMessage(u.value,v.value,a.value),v.value="",a.value=[]}catch(_){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ:",_)}}function N(){r.value&&r.value.scrollTo({top:r.value.scrollHeight,behavior:"smooth"})}function W(){i.value&&i.value.click()}function Z(_){console.log("ÐºÐ»Ð¸ÐºÐ°ÑŽ");const o=_.target;o.files&&o.files.length>0&&(a.value=[...a.value,...Array.from(o.files)])}function E(_){a.value.splice(_,1)}return(_,o)=>{var p;return n(),l(M,null,[e("section",{class:"chat-area",ref_key:"chatContainer",ref:r},[(n(!0),l(M,null,V(c.value,b=>{var U,P;return n(),l("div",{key:b.id,class:"message"},[e("div",ts,[m(J,{name:h.value[b.userId].nickname,avatar:h.value[b.userId].avatar},null,8,["name","avatar"])]),e("div",ss,[e("div",ns,[e("span",os,g((U=h.value[b.userId])==null?void 0:U.nickname),1),e("span",as,g(A(ue)(b.createdAt)),1)]),e("div",ls,g(b.text),1),e("div",is,[((P=b.attachments)==null?void 0:P.length)>0?(n(),T(es,{key:0,files:b.attachments,direction:"vertical","need-close-button":!1},null,8,["files"])):S("",!0)])])])}),128))],512),e("div",rs,[e("div",cs,[((p=a.value)==null?void 0:p.length)>0?(n(),T(Wt,{key:0,files:a.value,direction:"horizontal","need-close-button":!0,onDelete:E},null,8,["files"])):S("",!0)]),e("footer",{class:"message-input",onPaste:k,onDragover:o[2]||(o[2]=z(()=>{},["prevent"])),onDrop:B},[e("div",{class:"clipicon-wrapper",onClick:o[0]||(o[0]=b=>W())},[m(zt,{"fill-color":"white",size:"55%",class:"clipicon"})]),e("input",{type:"file",accept:"image/*, .pdf, .txt",onChange:Z,ref_key:"fileInput",ref:i,hidden:"",multiple:""},null,544),D(e("input",{type:"text",placeholder:"Type a message...","onUpdate:modelValue":o[1]||(o[1]=b=>v.value=b),onKeydown:ie(z(H,["prevent"]),["enter"])},null,40,us),[[F,v.value]]),e("button",{class:"send-button",onClick:H},"Send")],32)])],64)}}}),vs=I(ds,[["__scopeId","data-v-a1d5863b"]]),_s={class:"sidebar-users"},ms={class:"user-list"},ps={class:"user-avatar"},fs={class:"user-name"},hs=y({__name:"MembersSidebar",setup(f){const t=j(),s=C(()=>t.getCommunityMembers);return(a,i)=>(n(),l("div",_s,[i[0]||(i[0]=e("div",{class:"top-bar"},null,-1)),e("ul",ms,[(n(!0),l(M,null,V(s.value,u=>(n(),l("li",{key:u.userId,class:"user-item"},[e("div",ps,[m(Q,{name:u.nickname,avatar:u.avatar,status:u.status},null,8,["name","avatar","status"])]),e("span",fs,g(u.nickname),1)]))),128))])]))}}),Cs=I(hs,[["__scopeId","data-v-c0d74dec"]]),gs={class:"app-container"},$s={class:"sidebar"},ws={class:"main-content"},ys={class:"profile"},bs={class:"main-content"},ks={class:"community-member"},Us=y({__name:"MainPage",setup(f){return(t,s)=>(n(),l("div",gs,[m(st),e("div",$s,[e("div",ws,[m(bt)]),e("div",ys,[m(Ee)])]),e("main",bs,[m(Vt),m(vs)]),e("div",ks,[m(Cs)])]))}});export{Us as default};
