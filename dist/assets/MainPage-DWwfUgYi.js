import{d as g,j as a,q as V,g as M,c,f as u,a as t,t as h,s as Y,T as q,w as N,e as I,l as v,n as z,u as T,r as p,b as U,x as E,k as L,p as F,F as x,y as tt,z as A,A as D,v as P,R as H,i as et,B as st,C as nt,D as at,o as ot,E as lt,G as it}from"./index-B0z28gQ6.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as G,f as K}from"./formatedTime-30eLPBU5.js";import{a as rt,_ as ct}from"./phone-XeyzPViJ.js";const ut={class:"modal-content"},dt={class:"modal-header"},vt={class:"modal-body"},_t=g({__name:"ModalWindow",props:{show:{type:Boolean},title:{}},emits:["close"],setup(C,{emit:e}){const s=e;function o(){s("close")}return(n,i)=>(a(),V(q,{name:"fade"},{default:M(()=>[n.show?(a(),c("div",{key:0,class:"modal-overlay",onClick:N(o,["self"])},[u(q,{name:"slide"},{default:M(()=>[t("div",ut,[t("div",dt,[t("h2",null,h(n.title),1),t("button",{onClick:o,class:"close-btn"},"×")]),t("div",vt,[Y(n.$slots,"default",{},void 0,!0)])])]),_:3})])):I("",!0)]),_:3}))}}),B=w(_t,[["__scopeId","data-v-1b0bf03f"]]),mt={class:"avatar-container"},pt=g({__name:"AvatarWithStatus",props:{avatar:{},name:{},status:{}},setup(C){const e=C,s=v(()=>e.avatar),o=v(()=>e.name),n=v(()=>e.status);return(i,l)=>(a(),c("div",mt,[u(G,{name:o.value,avatar:s.value,class:"profile-avatar"},null,8,["name","avatar"]),t("span",{class:z(["status-dot",[n.value==="Online"?"online":n.value==="DoNotDisturb"?"dnd":"invisible"]])},null,2)]))}}),W=w(pt,[["__scopeId","data-v-b56f0ac9"]]),ht={class:"user-profile-top"},ft={class:"user-info-top"},Ct={class:"avatar"},$t={class:"user-names"},gt={class:"status-section"},yt={class:"user-info"},bt={key:0},wt=g({__name:"UserProfile",setup(C){const e=T(),s=v(()=>e.currentUser),o=p(e.currentUser.selectedStatus);function n(){o.value&&e.setStatus(o.value)}return(i,l)=>(a(),c("div",ht,[t("div",ft,[t("div",Ct,[u(W,{avatar:s.value.avatar,name:s.value.identityName,status:s.value.selectedStatus},null,8,["avatar","name","status"])]),t("div",$t,[t("h2",null,h(s.value.nickname)+" @"+h(s.value.identityName),1),t("div",gt,[U(t("select",{"onUpdate:modelValue":l[0]||(l[0]=_=>o.value=_),onChange:l[1]||(l[1]=_=>n()),class:"status-select"},l[2]||(l[2]=[t("option",{value:"Online"},"Online",-1),t("option",{value:"DoNotDisturb"},"Don't disturb",-1),t("option",{value:"Invisible"},"Invisible",-1)]),544),[[E,o.value]])])])]),t("div",yt,[t("p",null,[l[3]||(l[3]=t("strong",null,"Last change:",-1)),L(" "+h(F(K)(s.value.credentialsChangeDate)),1)]),t("p",null,[l[4]||(l[4]=t("strong",null,"Email:",-1)),L(" "+h(s.value.email),1)]),s.value.description?(a(),c("p",bt,[l[5]||(l[5]=t("strong",null,"About",-1)),L(" "+h(s.value.description),1)])):I("",!0)])]))}}),kt=w(wt,[["__scopeId","data-v-234c5043"]]),St={};function It(C,e){return null}const Mt=w(St,[["render",It]]),xt={class:"logout-section"},Ut=g({__name:"Logout",setup(C){const e=T();function s(){e.logout(),tt.push("/login")}return(o,n)=>(a(),c(x,null,[n[1]||(n[1]=t("p",null,[t("strong",null,"Do you want to log out of your account?")],-1)),t("div",null,[t("div",xt,[t("button",{class:"logout-button",onClick:n[0]||(n[0]=i=>s())},"Logout")])])],64))}}),Vt=w(Ut,[["__scopeId","data-v-12e857ec"]]),Nt={class:"user-card"},Tt={class:"settings-container"},At={class:"settings-menu"},Pt=["onClick"],Bt={class:"content-container"},zt={class:"settings-content"},Dt=g({__name:"UserView",setup(C){const e=T();v(()=>e.currentUser);const s=["Profile","Settings","Logout"],o=p(s[0]);function n(i){o.value=i}return(i,l)=>(a(),c("div",Nt,[t("div",Tt,[t("aside",At,[t("ul",null,[(a(),c(x,null,A(s,(_,d)=>t("li",{key:d},[t("button",{class:z({active:o.value===_}),onClick:y=>n(_)},h(_),11,Pt)])),64))])])]),t("div",Bt,[t("main",zt,[o.value==="Profile"?(a(),V(kt,{key:0})):o.value==="Settings"?(a(),V(Mt,{key:1})):o.value==="Logout"?(a(),V(Vt,{key:2})):I("",!0)])])]))}}),Lt=w(Dt,[["__scopeId","data-v-327a5efd"]]),Wt={class:"profile-widget"},qt={class:"avatar"},Et={class:"profile-info"},Ft={class:"username"},Ht={class:"user-tag"},Gt=g({__name:"ProfileCard",setup(C){const e=T(),s=v(()=>e.currentUser.avatar),o=v(()=>e.currentUser.nickname),n=v(()=>e.currentUser.identityName),i=v(()=>e.currentUser.selectedStatus),l=p(!1);return(_,d)=>(a(),c("div",Wt,[t("div",qt,[u(W,{avatar:s.value,name:o.value,status:i.value},null,8,["avatar","name","status"])]),t("div",Et,[t("div",Ft,h(o.value),1),t("div",Ht,"@"+h(n.value),1)]),t("button",{class:"settings-button",onClick:d[0]||(d[0]=y=>l.value=!0)},d[2]||(d[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:"20",height:"20",class:"settings-icon"},[t("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.5-.03-.62.19l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.5.03.62-.19l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"})],-1)])),u(B,{show:l.value,title:"User Environment",onClose:d[1]||(d[1]=y=>l.value=!1)},{default:M(()=>[u(Lt)]),_:1},8,["show"])]))}}),Kt=w(Gt,[["__scopeId","data-v-816811b2"]]),Ot=["width","height"],Rt=["fill"],O=g({__name:"CreateIcon",props:{fillColor:{},size:{}},setup(C){return(e,s)=>(a(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",width:e.size,height:e.size},[t("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z",fill:e.fillColor},null,8,Rt)],8,Ot))}}),jt={class:"sidebar-communities"},Zt={class:"community-list"},Jt=["onClick"],Qt={class:"community-avatar"},Xt={class:"add-community-button"},Yt={key:0,class:"success-message"},te=g({__name:"CommunitySidebar",setup(C){const e=new H("https://dotflopp.ru/api"),s=D(),o=p(!1),n=p(""),i=p(""),l=v(()=>s.communities),_=v(()=>s.activeCommunityId);function d(b){s.setActiveCommunity(b)}async function y(){if(n.value.trim())try{const b=await e.createNewCommunities(n.value);s.addCommunity(b),i.value="Сообщество успешно создано!"}catch(b){console.error("Ошибка при создании сообщества:",b),i.value="Не удалось создать сообщество."}}return(b,m)=>(a(),c("div",jt,[t("ul",Zt,[(a(!0),c(x,null,A(l.value,f=>(a(),c("li",{key:f.id,class:z(["community-item",{active:f.id===_.value}]),onClick:S=>d(f.id)},[t("div",Qt,[f.avatar?I("",!0):(a(),V(G,{key:0,name:f.name,avatar:f.avatar},null,8,["name","avatar"]))])],10,Jt))),128))]),t("div",Xt,[t("button",{class:"add-btn",onClick:m[0]||(m[0]=f=>o.value=!0)},[u(O,{fillColor:"white",size:"70%"})]),u(B,{show:o.value,title:"Creating Community",onClose:m[2]||(m[2]=f=>o.value=!1)},{default:M(()=>[t("form",{onSubmit:N(y,["prevent"]),class:"community-form"},[U(t("input",{id:"community-name","onUpdate:modelValue":m[1]||(m[1]=f=>n.value=f),type:"text",placeholder:"community name",required:""},null,512),[[P,n.value]]),i.value?(a(),c("p",Yt,h(i.value),1)):I("",!0),m[3]||(m[3]=t("button",{type:"submit",class:"create-button"},"Create",-1))],32)]),_:1},8,["show"])])]))}}),ee=w(te,[["__scopeId","data-v-fc60142f"]]),se={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none"},ne={"clip-path":"url(#clip0_2311_9433)"},ae=["fill"],oe=g({__name:"PersonIcon",props:{fillColor:{}},setup(C){return(e,s)=>(a(),c("svg",se,[t("g",ne,[t("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V19C4 19.55 4.45 20 5 20H19C19.55 20 20 19.55 20 19V18C20 15.34 14.67 14 12 14Z",fill:e.fillColor},null,8,ae)])]))}}),le={key:0,class:"sidebar-content"},ie={class:"current-communities"},re={class:"community-card"},ce={class:"community-name"},ue={key:0,class:"message"},de={class:"sidebar-channels"},ve={class:"channel-list"},_e=["onClick"],me={class:"channel"},pe={class:"channel-name"},he=["onClick"],fe={class:"add-channel-button"},Ce={class:"channel-type"},$e={class:"status-section"},ge={key:0,class:"message"},ye=g({__name:"ChannelSidebar",setup(C){const e=new H("https://dotflopp.ru/api"),s=D(),o=p(!1),n=p(""),i=p(""),l=p(!1),_=p(""),d=p("TextChannel"),y=p(""),b=v(()=>s.activeCommunityId),m=p("0"),f=v(()=>b.value?s.getCommunityById(b.value):null),S=v(()=>s.channels),R=v(()=>s.activeChannelId);function j(k){s.setActiveChannel(k)}async function Z(){if(n.value.trim())try{const r=`https://dotflopp.ru/invite/${(await e.createInvitation(s.getactiveCommunityId,n.value)).id}`;await navigator.clipboard.writeText(r),i.value="Invitation copied to clipboard"}catch(k){console.error("Ошибка при создании приглашения:",k),i.value="Не удалось создать приглашение."}}async function J(){if(!(!_.value.trim()||d.value.length==0))try{const k={name:_.value,type:d.value,parentId:m.value},r=await e.createNewChannel(b.value,k);console.log(r),s.addChannel(r),y.value="Канал успешно создан!",m.value="0"}catch(k){console.error("Ошибка при создании канала:",k),y.value="Не удалось создать канал."}}function Q(k){m.value=k}return(k,r)=>f.value?(a(),c("div",le,[t("div",ie,[t("div",re,[t("div",ce,h(f.value.name),1),t("button",{class:"addPerson-btn",onClick:r[0]||(r[0]=$=>o.value=!0)},[u(oe,{class:"addPerson",fillColor:"white"})]),u(B,{show:o.value,title:"Create Invitation",onClose:r[2]||(r[2]=$=>o.value=!1)},{default:M(()=>[t("form",{onSubmit:N(Z,["prevent"]),class:"invitation-form"},[U(t("input",{id:"lifetime","onUpdate:modelValue":r[1]||(r[1]=$=>n.value=$),type:"text",placeholder:"Seconds",required:""},null,512),[[P,n.value]]),i.value?(a(),c("p",ue,h(i.value),1)):I("",!0),r[7]||(r[7]=t("button",{type:"submit",class:"create-button"},"Create Invitation",-1))],32)]),_:1},8,["show"])])]),t("div",de,[t("ul",ve,[(a(!0),c(x,null,A(S.value,$=>(a(),c("li",{key:$.id,class:z(["channel-item",{active:$.id===R.value}]),onClick:X=>j($.id)},[t("div",me,[t("div",pe,h($.name),1),t("button",{class:"addChannel-btn-simple",onClick:X=>(l.value=!0,Q($.id))},[u(O,{fillColor:"white",size:"100%"})],8,he)])],10,_e))),128))]),t("div",fe,[t("button",{class:"addChannel-btn",onClick:r[3]||(r[3]=$=>l.value=!0)},r[8]||(r[8]=[t("p",null,"create channel",-1)]))]),u(B,{show:l.value,title:"Create channel",onClose:r[6]||(r[6]=$=>l.value=!1)},{default:M(()=>[t("form",{onSubmit:N(J,["prevent"]),class:"invitation-form"},[U(t("input",{id:"channelName","onUpdate:modelValue":r[4]||(r[4]=$=>_.value=$),type:"text",placeholder:"channel name",required:""},null,512),[[P,_.value]]),t("div",Ce,[r[10]||(r[10]=t("p",null,"Channel type",-1)),t("div",$e,[U(t("select",{"onUpdate:modelValue":r[5]||(r[5]=$=>d.value=$),class:"channeltype-select"},r[9]||(r[9]=[t("option",{value:"TextChannel"},"TextChannel",-1),t("option",{value:"ForkChannel"},"ForkChannel",-1),t("option",{value:"VoiceChannel"},"VoiceChannel",-1),t("option",{value:"CategoryChannel"},"CategoryChannel",-1)]),512),[[E,d.value]])])]),y.value?(a(),c("p",ge,h(y.value),1)):I("",!0),r[11]||(r[11]=t("button",{type:"submit",class:"create-button"},"Create Channel",-1))],32)]),_:1},8,["show"])])])):I("",!0)}}),be=w(ye,[["__scopeId","data-v-74d09c3a"]]),we={},ke={class:"top-bar"},Se={class:"call-icons"},Ie={class:"call-icon",id:"phone-btn"},Me={class:"call-icon",id:"camera-btn"};function xe(C,e){const s=et("router-link");return a(),c("header",ke,[e[2]||(e[2]=t("div",{class:"server-name"},"Chat",-1)),t("div",Se,[t("button",Ie,[u(s,{to:"/rooms"},{default:M(()=>e[0]||(e[0]=[t("img",{src:rt},null,-1)])),_:1})]),t("button",Me,[u(s,{to:"/rooms"},{default:M(()=>e[1]||(e[1]=[t("img",{src:ct},null,-1)])),_:1})])])])}const Ue=w(we,[["render",xe],["__scopeId","data-v-43526aa7"]]),Ve={class:"message-content"},Ne={class:"message-header"},Te={class:"timestamp"},Ae={class:"message-body"},Pe={class:"message-input"},Be=["onKeydown"],ze=g({__name:"Chat",setup(C){const e=st(),s=D();T(),nt();const o=v(()=>s.activeChannelId),n=v(()=>e.getMessages),i=p(null),l=p("");p();const _=at("CGW");function d(m){e.addMessage(m),b()}ot(()=>{e.fetchMessages(o.value),_.on("MessageCreated",d)}),lt(()=>{_.off("MessageCreated",d)});async function y(){if(l.value.trim())try{await e.sendMessage(o.value,l.value),l.value=""}catch(m){console.error("Ошибка отправки сообщения:",m)}}function b(){i.value&&(i.value.scrollTop=i.value.scrollHeight)}return(m,f)=>(a(),c(x,null,[t("section",{class:"chat-area",ref_key:"chatContainer",ref:i},[(a(!0),c(x,null,A(n.value,S=>(a(),c("div",{key:S.id,class:"message"},[t("div",Ve,[t("div",Ne,[t("span",Te,h(F(K)(S.createdAt)),1)]),t("div",Ae,h(S.text),1)])]))),128))],512),t("footer",Pe,[U(t("input",{type:"text",placeholder:"Type a message...","onUpdate:modelValue":f[0]||(f[0]=S=>l.value=S),onKeydown:it(N(y,["prevent"]),["enter"])},null,40,Be),[[P,l.value]]),t("button",{class:"send-button",onClick:y},"Send")])],64))}}),De=w(ze,[["__scopeId","data-v-cf798c61"]]),Le={class:"sidebar-users"},We={class:"user-list"},qe={class:"user-avatar"},Ee={class:"user-name"},Fe=g({__name:"MembersSidebar",setup(C){const e=D(),s=v(()=>e.getCommunityMembers);return(o,n)=>(a(),c("div",Le,[n[0]||(n[0]=t("div",{class:"top-bar"},null,-1)),t("ul",We,[(a(!0),c(x,null,A(s.value,i=>(a(),c("li",{key:i.userId,class:"user-item"},[t("div",qe,[u(W,{name:i.nickname,avatar:i.avatar,status:i.status},null,8,["name","avatar","status"])]),t("span",Ee,h(i.nickname),1)]))),128))])]))}}),He=w(Fe,[["__scopeId","data-v-2903eef0"]]),Ge={class:"app-container"},Ke={class:"sidebar"},Oe={class:"main-content"},Re={class:"profile"},je={class:"main-content"},Ze={class:"community-member"},ts=g({__name:"MainPage",setup(C){return(e,s)=>(a(),c("div",Ge,[u(ee),t("div",Ke,[t("div",Oe,[u(be)]),t("div",Re,[u(Kt)])]),t("main",je,[u(Ue),u(De)]),t("div",Ze,[u(He)])]))}});export{ts as default};
